<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova CPA 2026 - StudyBank</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out forwards;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .mind-map-node {
            position: relative;
        }
        .mind-map-node::before {
            content: '';
            position: absolute;
            left: -16px;
            top: 50%;
            width: 16px;
            height: 2px;
            background-color: #CBD5E1;
        }
        .keyword-tag {
            background-color: #FEF3C7;
            color: #92400E;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-900 selection:bg-indigo-200">

    <!-- Header Fixo -->
    <header class="bg-white shadow-sm sticky top-0 z-20 border-b border-gray-100">
        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="bg-indigo-600 p-1.5 rounded-lg">
                    <i data-lucide="graduation-cap" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold tracking-tight text-gray-800 leading-none">
                        Nova CPA <span class="text-indigo-600">2026</span>
                    </h1>
                    <span class="text-[10px] font-semibold text-gray-400 uppercase tracking-wider">Certificação Base</span>
                </div>
            </div>
            <div class="hidden sm:flex items-center gap-4 text-xs font-medium text-gray-500">
                <span class="flex items-center gap-1"><i data-lucide="clock" class="w-3 h-3"></i> 6-8 Semanas</span>
                <span class="flex items-center gap-1"><i data-lucide="book" class="w-3 h-3"></i> 4 Módulos</span>
            </div>
        </div>
        
        <!-- Navegação Horizontal (Scrollable) -->
        <div class="max-w-4xl mx-auto px-4 pb-0 overflow-x-auto no-scrollbar bg-white">
            <div class="flex space-x-6 border-b border-gray-100" id="tabs-container">
                <!-- Abas geradas via JS -->
            </div>
        </div>
    </header>

    <!-- Conteúdo Principal -->
    <main class="max-w-4xl mx-auto p-4 pb-32" id="main-content">
        <!-- Conteúdo injetado via JS -->
    </main>

    <!-- Botão Flutuante (FAB) -->
    <div class="fixed bottom-6 right-6 z-40 flex flex-col items-end gap-3">
        <div id="study-tip" class="hidden bg-white p-3 rounded-lg shadow-xl border border-gray-100 max-w-xs text-xs text-gray-600 animate-fadeIn mb-2 relative">
            <div class="absolute -bottom-2 right-6 w-4 h-4 bg-white transform rotate-45 border-b border-r border-gray-100"></div>
            <strong>Dica:</strong> Seu banco agora tem 100 questões! Pratique.
        </div>
        <button onclick="openQuiz()" class="bg-indigo-600 hover:bg-indigo-700 text-white rounded-full px-6 py-4 shadow-lg shadow-indigo-200 transition-all active:scale-95 flex items-center gap-2 font-bold cursor-pointer group">
            <i data-lucide="brain-circuit" class="w-5 h-5 group-hover:rotate-12 transition-transform"></i>
            <span>Simulado (100 Questões)</span>
        </button>
    </div>

    <!-- Modal do Quiz -->
    <div id="quiz-modal" class="fixed inset-0 bg-black/60 hidden flex items-center justify-center p-4 z-50 animate-fadeIn backdrop-blur-sm">
        <div class="bg-white rounded-2xl max-w-2xl w-full overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
            <!-- Header do Modal -->
            <div class="bg-indigo-600 p-5 flex justify-between items-center text-white">
                <div>
                    <h3 class="font-bold text-xl flex items-center gap-2">
                        <i data-lucide="check-circle-2" class="w-6 h-6"></i>
                        Simulado Completo
                    </h3>
                    <p class="text-indigo-200 text-xs mt-1">100 Questões - Estilo ANBIMA</p>
                </div>
                <button onclick="closeQuiz()" class="hover:bg-indigo-700 p-2 rounded-full transition-colors cursor-pointer bg-indigo-500/30">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>

            <!-- Corpo do Modal -->
            <div id="quiz-body" class="p-6 overflow-y-auto bg-gray-50 flex-1">
                <!-- Questões injetadas via JS -->
            </div>

            <!-- Footer do Modal -->
            <div id="quiz-footer" class="p-4 border-t border-gray-100 bg-white flex justify-between items-center">
                <!-- Botões e Progresso -->
            </div>
        </div>
    </div>

    <!-- Script Principal -->
    <script>
        // --- DADOS DO ESTUDO (NOVA CPA) ---
        const studyData = {
            plano: {
                id: "plano",
                title: "Plano de Estudos",
                icon: "calendar-clock",
                color: "bg-gray-800",
                textClass: "text-gray-800",
                borderClass: "border-gray-800",
                isPlan: true,
                steps: [
                    { week: "1-2", module: "Módulo 1: SFN", focus: "Estrutura, Órgãos (CMN, BC, CVM), Seguros (SUSEP, PREVIC) e Economia (PIB, IPCA).", action: "20-30 questões por tema." },
                    { week: "3-5", module: "Módulo 2: Produtos", focus: "Renda Fixa, Fundos, Variável, Previdência (O mais pesado!).", action: "Comparar risco x retorno x liquidez." },
                    { week: "6", module: "Módulo 3: Clientes", focus: "Suitability, Ética, PLD/FT.", action: "Foco em interpretação de texto." },
                    { week: "7", module: "Módulo 4: Inovação", focus: "ESG, Open Finance, Fintechs.", action: "Questões conceituais." },
                    { week: "8", module: "Revisão Final", focus: "Simulados completos.", action: "Corrigir erros e reler resumos." }
                ]
            },
            mod1: {
                id: "mod1",
                title: "M1: SFN & Economia",
                icon: "landmark",
                color: "bg-blue-600",
                textClass: "text-blue-600",
                borderClass: "border-blue-600",
                topics: [
                    {
                        title: "CMN (Conselho Monetário Nacional)",
                        keywords: ["MANDA", "NORMATIVO", "META INFLAÇÃO"],
                        description: "Órgão máximo do SFN. Ele NÃO executa, ele manda.",
                        practicalCase: "O CMN se reúne e decide que a meta de inflação para o ano que vem será de 3%. Ele não vai ao mercado comprar títulos; ele apenas dá a ordem para o Banco Central 'se virar' para atingir essa meta.",
                        details: [
                            { label: "Função Principal", value: "Formular a política da moeda e do crédito. Define a META de inflação." },
                            { label: "Composição", value: "Ministro da Fazenda (Presidente), Ministro do Planejamento, Presidente do Bacen." },
                            { label: "Dica de Prova", value: "Se o verbo for 'Autorizar', 'Regular', 'Fixar diretrizes' = CMN." }
                        ]
                    },
                    {
                        title: "BACEN (Banco Central do Brasil)",
                        keywords: ["EXECUTA", "FISCALIZA BANCOS", "SELIC", "COMPULSÓRIO"],
                        description: "O banco dos bancos. Garante que as ordens do CMN sejam cumpridas.",
                        practicalCase: "Se a inflação está alta, o Bacen aumenta a taxa Selic para desestimular o consumo. Se um banco está prestes a quebrar, o Bacen decreta intervenção.",
                        details: [
                            { label: "Função Principal", value: "Fiscalizar instituições financeiras, emitir papel-moeda, controlar liquidez via Depósito Compulsório e Redesconto." },
                            { label: "Autonomia", value: "Possui autonomia operacional (não subordinado hierarquicamente ao Ministério da Fazenda)." },
                            { label: "Dica de Prova", value: "Se o verbo for 'Fiscalizar', 'Executar', 'Punir' bancos = BACEN." }
                        ]
                    },
                    {
                        title: "CVM (Comissão de Valores Mobiliários)",
                        keywords: ["BOLSA", "FUNDOS", "S.A. ABERTA"],
                        description: "A 'polícia' do mercado de capitais (Bolsa, Fundos).",
                        practicalCase: "Se a Petrobras divulga um balanço falso, a CVM investiga e pune. Se um Fundo de Investimento engana cotistas, a CVM atua.",
                        details: [
                            { label: "Objetivo", value: "Proteger o investidor e garantir transparência nas S.A. e Fundos." },
                            { label: "Não regula", value: "Não mexe com Conta Corrente, Cheque ou Crédito Bancário (isso é Bacen)." }
                        ]
                    },
                    {
                        title: "Seguros: CNSP e SUSEP",
                        keywords: ["SEGUROS", "CAPITALIZAÇÃO", "PREVIDÊNCIA ABERTA"],
                        description: "Dupla que cuida de seguros, capitalização e previdência aberta (PGBL/VGBL).",
                        practicalCase: "Se você contrata um seguro de carro (Porto Seguro) ou um PGBL (Brasilprev), quem regula as normas é o CNSP e quem fiscaliza se a empresa tem dinheiro para te pagar é a SUSEP.",
                        details: [
                            { label: "CNSP (Normativo)", value: "Conselho Nacional de Seguros Privados. Manda/Cria normas." },
                            { label: "SUSEP (Executor)", value: "Superintendência de Seguros Privados. Fiscaliza." }
                        ]
                    },
                    {
                        title: "Previdência Fechada: CNPC e PREVIC",
                        keywords: ["FUNDOS DE PENSÃO", "PREVI", "PETROS"],
                        description: "Dupla que cuida dos Fundos de Pensão (Previdência Fechada - só para funcionários).",
                        practicalCase: "A Previ (fundo dos funcionários do BB) ou a Petros (Petrobras) são fiscalizadas pela PREVIC.",
                        details: [
                            { label: "CNPC (Normativo)", value: "Conselho Nacional de Previdência Complementar. Cria regras." },
                            { label: "PREVIC (Executor)", value: "Superintendência Nacional de Previdência Complementar. Fiscaliza." }
                        ]
                    },
                    {
                        title: "PIB (Produto Interno Bruto)",
                        keywords: ["SOMA DE RIQUEZAS", "FLUXO", "C+I+G+X-M"],
                        description: "A soma de todos os bens e serviços finais produzidos no país.",
                        practicalCase: "A padaria vender pão conta para o PIB. A padaria vender um forno usado NÃO conta (já foi contado quando era novo). Trabalho voluntário e dona de casa não contam.",
                        details: [
                            { label: "Fórmula (Ótica da Despesa)", value: "PIB = C (Consumo Famílias) + I (Investimento Empresas) + G (Gastos Governo) + NX (Exportações - Importações)." },
                            { label: "Conceito", value: "Mede o fluxo de produção, não o estoque de riqueza." }
                        ]
                    },
                    {
                        title: "IPCA (Índice Nacional de Preços ao Consumidor Amplo)",
                        keywords: ["INFLAÇÃO OFICIAL", "IBGE", "META"],
                        description: "Índice oficial de inflação usado para a meta.",
                        practicalCase: "O IBGE pesquisa o preço da cesta de compras (arroz, gasolina, escola, médico) de famílias que ganham de 1 a 40 salários mínimos.",
                        details: [
                            { label: "Calculado por", value: "IBGE." },
                            { label: "Período", value: "Do dia 01 ao dia 30/31 do mês." },
                            { label: "Abrangência", value: "9 regiões metropolitanas + DF + Goiânia + Outros." }
                        ]
                    },
                    {
                        title: "IGP-M (Índice Geral de Preços - Mercado)",
                        keywords: ["ALUGUEL", "FGV", "60-30-10"],
                        description: "Calculado pela FGV. Muito afetado pelo Dólar (atacado).",
                        practicalCase: "Usado para reajustar contratos de aluguel. Se o dólar dispara, o IGP-M sobe muito mais que o IPCA, encarecendo o aluguel.",
                        details: [
                            { label: "Composição (Decoreba!)", value: "60% IPA (Atacado) + 30% IPC (Consumidor) + 10% INCC (Construção Civil)." },
                            { label: "Apelido", value: "'Inflação do Aluguel'." }
                        ]
                    }
                ]
            },
            mod2: {
                id: "mod2",
                title: "M2: Produtos",
                icon: "package",
                color: "bg-purple-600",
                textClass: "text-purple-600",
                borderClass: "border-purple-600",
                topics: [
                    {
                        title: "CDB (Certificado de Depósito Bancário)",
                        keywords: ["CRÉDITO PRIVADO", "FGC", "REGRESSIVO"],
                        description: "Título onde você empresta dinheiro para o banco financiar suas operações.",
                        practicalCase: "Você aplica R$ 10.000 num CDB do Banco X que paga 110% do CDI. O Banco X pega esse dinheiro e empresta para o João no Cheque Especial cobrando 8% ao mês. O spread é o lucro do banco.",
                        details: [
                            { label: "Risco", value: "Crédito da instituição (Coberto pelo FGC até R$ 250k)." },
                            { label: "Tributação", value: "IR Tabela Regressiva (22,5% a 15%)." }
                        ]
                    },
                    {
                        title: "LCI & LCA (Letras de Crédito)",
                        keywords: ["ISENÇÃO IR", "IMOBILIÁRIO", "AGRONEGÓCIO"],
                        description: "LCI (Letra de Crédito Imobiliário) e LCA (Letra de Crédito do Agronegócio).",
                        practicalCase: "O banco emite uma LCA para captar dinheiro e emprestar para um produtor de soja comprar tratores. Por ajudar o agro, o governo isenta você (PF) de IR.",
                        details: [
                            { label: "Vantagem", value: "ISENTO de IR para Pessoa Física." },
                            { label: "Desvantagem", value: "Carência mínima de 90 dias (LCI) ou 9 meses (LCA)." },
                            { label: "Risco", value: "Tem FGC." }
                        ]
                    },
                    {
                        title: "Debêntures",
                        keywords: ["DÍVIDA EMPRESARIAL", "SEM FGC", "INFRAESTRUTURA"],
                        description: "Títulos de dívida emitidos por empresas S.A. (não financeiras).",
                        practicalCase: "A Vale (mineradora) precisa construir uma ferrovia. Em vez de pedir empréstimo caro no banco, ela emite Debêntures e pega dinheiro direto com investidores.",
                        details: [
                            { label: "Debênture Incentivada", value: "Financia infraestrutura (estrada, energia). ISENTA de IR para PF." },
                            { label: "Risco", value: "Crédito da empresa (SEM FGC). Se a Vale quebrar, você vai para a fila de credores." }
                        ]
                    },
                    {
                        title: "Tesouro Direto",
                        keywords: ["RISCO SOBERANO", "MARCAÇÃO A MERCADO"],
                        description: "Plataforma para PF comprar títulos públicos federais.",
                        practicalCase: "Você empresta para o Governo Federal pagar as contas dele. É o risco mais baixo do país (Risco Soberano), pois o governo pode emitir moeda para pagar.",
                        subTopics: [
                            { name: "Tesouro Selic (LFT)", text: "Pós-fixado. Segue a Selic. Se a Selic sobe, ele rende mais. Ideal para Reserva." },
                            { name: "Tesouro Prefixado (LTN)", text: "Taxa fixa (ex: 12%). Se os juros de mercado subirem para 15%, seu título desvaloriza se vender antes (Marcação a Mercado)." },
                            { name: "Tesouro IPCA+ (NTN-B)", text: "Paga IPCA + Juro Fixo. Protege o poder de compra no longo prazo." }
                        ],
                        details: [
                             { label: "Liquidez", value: "D+1 (Solicita hoje, cai amanhã)." }
                        ]
                    },
                    {
                        title: "Fundos de Investimento",
                        keywords: ["CONDOMÍNIO", "COTA", "CNPJ PRÓPRIO"],
                        description: "Comunhão de recursos sob gestão profissional. Cada investidor tem cotas.",
                        practicalCase: "Você não sabe qual ação comprar. Você investe num Fundo de Ações. O Gestor (profissional) escolhe comprar Petrobras e Itaú. Se as ações sobem, sua cota valoriza.",
                        details: [
                            { label: "Come-cotas", value: "Antecipação semestral de IR (Maio/Nov) em fundos de Renda Fixa, Cambial e Multimercado." },
                            { label: "Fundo de Ações", value: "NÃO tem come-cotas. IR de 15% só no resgate." }
                        ]
                    },
                    {
                        title: "Previdência (PGBL x VGBL)",
                        keywords: ["LONGO PRAZO", "DEDUÇÃO FISCAL", "SUCESSÃO"],
                        description: "Plano Gerador de Benefício Livre (PGBL) e Vida Gerador de Benefício Livre (VGBL).",
                        practicalCase: "João ganha R$ 200 mil/ano e declara completo. Ele faz PGBL para abater R$ 24 mil da base de cálculo e pagar menos IR hoje (difere o imposto). Maria é isenta; ela faz VGBL apenas para sucessão patrimonial.",
                        details: [
                            { label: "PGBL", value: "Deduz IR na entrada (até 12%). Paga IR sobre TUDO na saída." },
                            { label: "VGBL", value: "Não deduz. Paga IR só sobre o LUCRO na saída." }
                        ]
                    }
                ]
            },
            mod3: {
                id: "mod3",
                title: "M3: Clientes",
                icon: "users",
                color: "bg-orange-600",
                textClass: "text-orange-600",
                borderClass: "border-orange-600",
                topics: [
                    {
                        title: "Suitability (API)",
                        keywords: ["PERFIL", "ADEQUAÇÃO", "OBRIGATÓRIO"],
                        description: "Análise de Perfil do Investidor (API).",
                        practicalCase: "Dona Maria tem 80 anos e precisa do dinheiro para remédios (Conservadora). O gerente não pode colocar o dinheiro dela em Ações (Risco Alto), mesmo que as ações estejam subindo.",
                        details: [
                            { label: "Perfis", value: "Conservador (Segurança), Moderado (Equilíbrio), Arrojado (Rentabilidade/Risco)." },
                            { label: "Desenquadramento", value: "Se o cliente quiser investir fora do perfil, deve assinar termo específico." }
                        ]
                    },
                    {
                        title: "PLD/FT (Lavagem de Dinheiro)",
                        keywords: ["COI", "SUSPEITA", "ESPÉCIE"],
                        description: "Prevenção à Lavagem de Dinheiro e Financiamento ao Terrorismo.",
                        practicalCase: "Um cliente que ganha R$ 2 mil/mês tenta depositar R$ 100 mil em dinheiro vivo na boca do caixa. Isso é uma operação suspeita e deve ser reportada ao COAF.",
                        details: [
                            { label: "Fases", value: "1. Colocação (introduz o dinheiro), 2. Ocultação (dificulta rastreio), 3. Integração (volta com aparência lícita)." },
                            { label: "Reporte", value: "Ao COAF. Não avisar o cliente." }
                        ]
                    }
                ]
            },
            mod4: {
                id: "mod4",
                title: "M4: Inovação",
                icon: "rocket",
                color: "bg-teal-600",
                textClass: "text-teal-600",
                borderClass: "border-teal-600",
                topics: [
                    {
                        title: "Open Finance",
                        keywords: ["CONSENTIMENTO", "COMPARTILHAMENTO"],
                        description: "Sistema financeiro aberto. O dado é do cliente.",
                        practicalCase: "Você tem conta no Banco A há 20 anos. Quer empréstimo no Banco B. Pelo Open Finance, você autoriza o Banco B a ver seu histórico positivo do Banco A para conseguir juros menores.",
                        details: [
                            { label: "Princípio Chave", value: "Consentimento: deve ser explícito, com finalidade e prazo determinados." }
                        ]
                    },
                    {
                        title: "ESG",
                        keywords: ["SUSTENTABILIDADE", "GOVERNANÇA", "SOCIAL"],
                        description: "Environmental (Ambiental), Social (Social) and Governance (Governança).",
                        practicalCase: "Investidores evitam comprar ações de uma empresa que polui rios (E) ou usa trabalho escravo (S), pois isso gera risco de imagem e multas.",
                        details: [
                            { label: "Greenwashing", value: "Maquiagem verde. Fingir que é sustentável sem ser." }
                        ]
                    }
                ]
            }
        };

        // --- BANCO DE QUESTÕES (100 Itens) ---
        const quizQuestions = [
            // MÓDULO 1 (Existentes)
            { m: "M1", q: "O órgão máximo do Sistema Financeiro Nacional é:", o: ["BACEN", "CVM", "ANBIMA", "CMN"], a: 3, e: "O Conselho Monetário Nacional (CMN) é o órgão NORMATIVO máximo. Ele manda, o Bacen executa." },
            { m: "M1", q: "A principal função do Banco Central é:", o: ["Criar leis financeiras", "Executar políticas monetárias e fiscalizar", "Regular o mercado de capitais", "Representar investidores"], a: 1, e: "O Bacen executa as ordens do CMN e fiscaliza os bancos (guardião da moeda)." },
            { m: "M1", q: "A CVM atua principalmente no:", o: ["Sistema bancário", "Mercado de crédito", "Mercado de capitais", "Mercado cambial"], a: 2, e: "CVM (Comissão de Valores Mobiliários) regula Bolsa, Fundos e S.A." },
            { m: "M1", q: "A ANBIMA é caracterizada como:", o: ["Órgão regulador estatal", "Autarquia federal", "Entidade de autorregulação", "Banco público"], a: 2, e: "ANBIMA é uma entidade privada de autorregulação (o mercado regulando a si mesmo)." },
            { m: "M1", q: "Qual instituição pode captar depósitos à vista?", o: ["Corretora", "Banco comercial", "Distribuidora", "CVM"], a: 1, e: "Apenas Bancos Comerciais (e Múltiplos com carteira comercial) e Cooperativas podem ter conta corrente." },
            { m: "M1", q: "O cálculo do PIB pela ótica da despesa segue a fórmula:", o: ["C + I + G + (X - M)", "C + I - G", "X - M", "C + I + G + T"], a: 0, e: "PIB = Consumo + Investimento + Gastos Gov + Exportações Líquidas (Exportação - Importação)." },
            { m: "M1", q: "A composição do IGP-M é:", o: ["50% IPA, 50% IPC", "60% IPA, 30% IPC, 10% INCC", "40% IPA, 30% IPC, 30% INCC", "100% IPCA"], a: 1, e: "O IGP-M é 60% Atacado (IPA), 30% Consumidor (IPC) e 10% Construção (INCC)." },
            { m: "M1", q: "Quem fiscaliza os Fundos de Pensão (Previdência Fechada)?", o: ["SUSEP", "PREVIC", "CVM", "CNSP"], a: 1, e: "Previdência Fechada = PREVIC. Previdência Aberta = SUSEP." },
            { m: "M1", q: "Taxa básica de juros da economia brasileira:", o: ["CDI", "IPCA", "Selic", "TR"], a: 2, e: "A Meta Selic é definida pelo COPOM (Bacen)." },
            { m: "M1", q: "O câmbio representa:", o: ["Preço de ativos", "Troca de títulos", "Preço da moeda estrangeira em reais", "Taxa de juros"], a: 2, e: "Câmbio é a relação de troca entre duas moedas." },
            
            // MÓDULO 1 (NOVAS)
            { m: "M1", q: "Em um cenário de alta inflação, qual medida é mais provável de ser adotada pelo BACEN?", o: ["Redução da Selic", "Aumento da Selic", "Redução do compulsório", "Expansão do crédito"], a: 1, e: "Aumentar a Selic encarece o crédito e desestimula o consumo, controlando a inflação." },
            { m: "M1", q: "Quem define as diretrizes da política monetária?", o: ["BACEN", "CVM", "Tesouro Nacional", "CMN"], a: 3, e: "O CMN define as diretrizes e metas; o BACEN executa." },
            { m: "M1", q: "A função principal da CVM é proteger:", o: ["Bancos", "O governo", "Investidores do mercado de capitais", "Instituições financeiras"], a: 2, e: "A CVM fiscaliza o mercado de valores mobiliários (ações, fundos, debêntures)." },
            { m: "M1", q: "Um banco comercial atua principalmente em:", o: ["Mercado de capitais", "Mercado de seguros", "Intermediação financeira com depósitos à vista", "Emissão de ações"], a: 2, e: "Bancos comerciais captam depósitos à vista (conta corrente) e emprestam a curto/médio prazo." },
            { m: "M1", q: "O SFN tem como objetivo principal:", o: ["Maximizar lucros bancários", "Garantir crédito apenas ao governo", "Promover desenvolvimento econômico com estabilidade", "Eliminar riscos financeiros"], a: 2, e: "O sistema busca intermediar recursos para desenvolver o país de forma equilibrada." },
            { m: "M1", q: "Quando o real se desvaloriza frente ao dólar, significa que:", o: ["O dólar ficou mais barato", "O real ganhou poder de compra", "É preciso mais reais para comprar dólares", "A inflação caiu automaticamente"], a: 2, e: "Desvalorização cambial encarece a moeda estrangeira." },
            { m: "M1", q: "O mercado primário ocorre quando:", o: ["Um título é revendido", "Um ativo é negociado na bolsa", "Há emissão de novos títulos", "Há especulação de preços"], a: 2, e: "Mercado primário é a primeira venda (o recurso vai para o emissor)." },
            { m: "M1", q: "O mercado secundário é importante porque:", o: ["Financia o governo", "Gera liquidez aos ativos", "Controla inflação", "Cria moeda"], a: 1, e: "Permite que investidores vendam seus ativos para outros, gerando liquidez." },
            { m: "M1", q: "O compulsório bancário serve para:", o: ["Aumentar o lucro dos bancos", "Controlar liquidez da economia", "Garantir rentabilidade", "Financiar empresas"], a: 1, e: "O BACEN recolhe parte dos depósitos para controlar a quantidade de dinheiro em circulação." },
            { m: "M1", q: "A política fiscal é conduzida principalmente pelo:", o: ["BACEN", "CMN", "Governo (Executivo)", "CVM"], a: 2, e: "Política fiscal refere-se a gastos e impostos do Governo." },

            // MÓDULO 2 (Existentes)
            { m: "M2", q: "O CDB é um título:", o: ["Público", "De renda variável", "Bancário de renda fixa", "Isento de IR"], a: 2, e: "CDB = Certificado de Depósito Bancário. Você empresta ao banco." },
            { m: "M2", q: "Qual produto possui cobertura do FGC?", o: ["Ações", "Debêntures", "CDB", "Fundos de ações"], a: 2, e: "CDB, LCI, LCA e Poupança têm FGC. Debêntures e Fundos NÃO." },
            { m: "M2", q: "LCI e LCA são isentas de:", o: ["IOF", "IR para pessoa física", "Taxa de administração", "Risco de crédito"], a: 1, e: "Isenção de IR para PF é o grande atrativo das Letras de Crédito." },
            { m: "M2", q: "O Tesouro Direto é emitido por:", o: ["Bancos", "Empresas", "Governo Federal", "Corretoras"], a: 2, e: "São títulos da dívida pública federal (Risco Soberano)." },
            { m: "M2", q: "O risco predominante da renda variável é:", o: ["Crédito", "Mercado", "Liquidez", "Operacional"], a: 1, e: "Risco de Mercado = Oscilação de preços (volatilidade)." },
            { m: "M2", q: "Fundos de investimento são:", o: ["Aplicações individuais", "Condomínios de investidores", "Produtos bancários", "Títulos públicos"], a: 1, e: "Funcionam como um condomínio: cada um tem uma cota (pedaço) do todo." },
            { m: "M2", q: "Taxa cobrada para gestão do fundo:", o: ["Performance", "Entrada", "Administração", "Custódia"], a: 2, e: "Taxa de Administração remunera o gestor e o administrador. Performance só se ganhar do benchmark." },
            { m: "M2", q: "A taxa de performance incide quando:", o: ["O fundo tem prejuízo", "O fundo supera um benchmark", "O cotista resgata", "O fundo é fechado"], a: 1, e: "É um prêmio pago ao gestor por entregar resultado ACIMA da meta (benchmark)." },
            { m: "M2", q: "Fundos de ações devem manter no mínimo:", o: ["51% em ações", "67% em ações", "80% em ações", "100% em ações"], a: 1, e: "Regra CVM: Mínimo de 67% (dois terços) em ações." },
            { m: "M2", q: "ETF é:", o: ["Fundo exclusivo", "Fundo que replica um índice", "Ação internacional", "Título de renda fixa"], a: 1, e: "Exchange Traded Fund = Fundo de Índice negociado em bolsa." },
            { m: "M2", q: "A principal característica da renda fixa é:", o: ["Retorno imprevisível", "Rentabilidade conhecida ou previsível", "Isenção de impostos", "Alta volatilidade"], a: 1, e: "As condições de remuneração são definidas no momento da aplicação." },
            { m: "M2", q: "Debêntures são títulos emitidos por:", o: ["Governo", "Bancos", "Empresas", "Corretoras"], a: 2, e: "Empresas S.A. não financeiras emitem debêntures para financiar projetos." },
            { m: "M2", q: "O risco de crédito está relacionado à:", o: ["Oscilação de preços", "Capacidade de pagamento do emissor", "Falta de liquidez", "Inflação"], a: 1, e: "Risco de Calote (Default). A empresa/banco não pagar o que deve." },
            { m: "M2", q: "O IR na renda fixa segue a tabela:", o: ["Progressiva", "Fixa", "Regressiva", "Isenta"], a: 2, e: "Quanto mais tempo fica, menos paga (22,5% até 15%)." },
            { m: "M2", q: "PGBL é mais indicado para quem:", o: ["Não declara IR", "Usa declaração completa", "Usa declaração simplificada", "É isento"], a: 1, e: "Permite abater até 12% da renda bruta anual tributável na declaração completa." },
            { m: "M2", q: "No VGBL, o IR incide sobre:", o: ["Valor total", "Apenas rendimentos", "Apenas aportes", "Taxas"], a: 1, e: "No VGBL, o imposto é só sobre o LUCRO. No PGBL, é sobre TUDO." },
            { m: "M2", q: "A previdência complementar tem foco em:", o: ["Curto prazo", "Liquidez diária", "Longo prazo", "Especulação"], a: 2, e: "Objetivo principal é aposentadoria (longuíssimo prazo)." },
            { m: "M2", q: "Capitalização tem como principal característica:", o: ["Investimento", "Proteção previdenciária", "Sorteios e formação de reserva", "Renda variável"], a: 2, e: "Capitalização NÃO é investimento. É um jogo de sorteio onde você guarda dinheiro (geralmente rendendo pouco)." },
            { m: "M2", q: "Maior liquidez geralmente está associada a:", o: ["Renda variável", "Longo prazo", "Menor risco", "Curto prazo"], a: 3, e: "Produtos de curto prazo ou liquidez diária permitem resgate rápido." },
            { m: "M2", q: "A diversificação tem como objetivo:", o: ["Eliminar riscos", "Aumentar impostos", "Reduzir riscos", "Garantir retorno"], a: 2, e: "Não elimina o risco sistêmico, mas reduz o risco específico da carteira." },

            // MÓDULO 2 (NOVAS)
            { m: "M2", q: "João investiu em um CDB de um banco médio. O principal risco que ele corre é:", o: ["Mercado", "Liquidez", "Crédito", "Operacional"], a: 2, e: "Risco de o banco quebrar (calote). Coberto pelo FGC." },
            { m: "M2", q: "Um investimento com rentabilidade atrelada ao IPCA protege contra:", o: ["Risco cambial", "Risco de crédito", "Inflação", "Oscilação da bolsa"], a: 2, e: "Garante a manutenção do poder de compra." },
            { m: "M2", q: "Qual produto NÃO possui garantia do FGC?", o: ["CDB", "LCI", "LCA", "Debênture"], a: 3, e: "Debêntures são títulos corporativos sem garantia do Fundo Garantidor." },
            { m: "M2", q: "Tesouro Selic é mais indicado para:", o: ["Longuíssimo prazo", "Especulação", "Reserva de emergência", "Alta rentabilidade"], a: 2, e: "Baixa volatilidade e liquidez diária." },
            { m: "M2", q: "Um fundo que investe majoritariamente em títulos públicos é classificado como:", o: ["Fundo multimercado", "Fundo cambial", "Fundo de renda fixa", "Fundo de ações"], a: 2, e: "Fundo de Renda Fixa busca retorno em ativos de juros." },
            { m: "M2", q: "Em um fundo, o administrador é responsável por:", o: ["Decidir investimentos", "Gestão da carteira", "Parte operacional e regulatória", "Definir benchmark"], a: 2, e: "O Administrador cuida do funcionamento legal. O Gestor decide onde investir." },
            { m: "M2", q: "A taxa de performance só pode ser cobrada se:", o: ["O fundo tiver prejuízo", "Superar o benchmark", "O cotista resgatar", "O mercado subir"], a: 1, e: "É um prêmio por superar a meta (benchmark)." },
            { m: "M2", q: "Um ETF é negociado:", o: ["Diretamente com o gestor", "No Tesouro Direto", "Na bolsa de valores", "Apenas no vencimento"], a: 2, e: "Cotas de ETF são compradas e vendidas na B3 como ações." },
            { m: "M2", q: "Qual produto é mais indicado para quem busca isenção de IR e baixo risco?", o: ["Ações", "LCI/LCA", "Debêntures", "Fundos multimercado"], a: 1, e: "LCI/LCA têm FGC e isenção de IR para PF." },
            { m: "M2", q: "A principal vantagem da diversificação é:", o: ["Garantir retorno", "Eliminar riscos", "Reduzir riscos", "Aumentar impostos"], a: 2, e: "Reduz o risco específico da carteira (não ponha todos ovos na mesma cesta)." },
            { m: "M2", q: "Debêntures incentivadas possuem como benefício:", o: ["Garantia do FGC", "Isenção de IR para PF", "Liquidez diária", "Proteção cambial"], a: 1, e: "Governo incentiva infraestrutura com isenção fiscal." },
            { m: "M2", q: "Risco de liquidez ocorre quando:", o: ["O emissor não paga", "O preço oscila", "Não é possível vender o ativo rapidamente", "A inflação sobe"], a: 2, e: "Dificuldade em transformar o ativo em dinheiro pelo preço justo." },
            { m: "M2", q: "A tabela regressiva de IR favorece investimentos:", o: ["De curto prazo", "Isentos", "De longo prazo", "De renda variável"], a: 2, e: "A alíquota cai com o tempo (mínima de 15% após 2 anos)." },
            { m: "M2", q: "Um fundo fechado significa que:", o: ["Não há taxa", "Não permite resgates antes do prazo", "É exclusivo", "Não tem risco"], a: 1, e: "Cotas só são resgatadas no encerramento do fundo (pode vender no mercado secundário)." },
            { m: "M2", q: "A cota de um fundo é calculada com base:", o: ["No lucro do gestor", "No patrimônio líquido do fundo", "No número de cotistas", "Na taxa Selic"], a: 1, e: "Patrimônio Líquido dividido pelo número de cotas." },
            { m: "M2", q: "PGBL permite:", o: ["Isenção total de IR", "Dedução até 12% da renda bruta tributável", "IR apenas sobre rendimento", "Resgate sem imposto"], a: 1, e: "Benefício fiscal na declaração completa." },
            { m: "M2", q: "VGBL é mais indicado para quem:", o: ["Faz declaração completa", "Não declara IR", "Usa declaração simplificada", "Busca curto prazo"], a: 2, e: "Simplificada ou isentos." },
            { m: "M2", q: "Previdência é indicada principalmente para:", o: ["Especulação", "Reserva imediata", "Planejamento de longo prazo", "Alta liquidez"], a: 2, e: "Foco em aposentadoria." },
            { m: "M2", q: "Título pós-fixado significa:", o: ["Taxa definida no início", "Rentabilidade atrelada a um indexador", "Sem risco", "Isento de imposto"], a: 1, e: "Segue um índice (Ex: 100% do CDI)." },
            { m: "M2", q: "Capitalização NÃO tem como objetivo principal:", o: ["Sorteios", "Formação de reserva", "Investimento", "Disciplina financeira"], a: 2, e: "Não é considerado investimento devido à baixa rentabilidade e caráter de sorteio." },


            // MÓDULO 3 (Existentes)
            { m: "M3", q: "Suitability significa:", o: ["Venda agressiva", "Adequação ao perfil do cliente", "Rentabilidade máxima", "Livre escolha"], a: 1, e: "API (Análise de Perfil de Investidor). Vender o produto certo para a pessoa certa." },
            { m: "M3", q: "Um cliente conservador prioriza:", o: ["Alta rentabilidade", "Segurança e liquidez", "Risco elevado", "Renda variável"], a: 1, e: "Ele prefere ganhar pouco a correr risco de perder o principal." },
            { m: "M3", q: "A ética profissional exige:", o: ["Foco na comissão", "Interesse da instituição", "Interesse do cliente", "Sigilo parcial"], a: 2, e: "O interesse do cliente deve sempre prevalecer sobre o do gerente/banco." },
            { m: "M3", q: "KYC significa:", o: ["Know Your Client", "Keep Your Capital", "Know Your Company", "Keep Your Client"], a: 0, e: "Conheça seu Cliente. Essencial para evitar lavagem de dinheiro." },
            { m: "M3", q: "Operações suspeitas devem ser:", o: ["Incentivadas", "Ignoradas", "Comunicadas ao COAF", "Autorizadas"], a: 2, e: "Qualquer atipicidade deve ser reportada ao COAF, sem avisar o cliente." },
            { m: "M3", q: "Planejamento financeiro envolve:", o: ["Apenas investimentos", "Apenas crédito", "Organização das finanças pessoais", "Apenas previdência"], a: 2, e: "É uma visão 360º: orçamento, dívidas, seguros, aposentadoria e investimentos." },
            { m: "M3", q: "Oferecer produto incompatível com o perfil:", o: ["É permitido", "Viola normas de conduta", "É recomendado", "Não gera impacto"], a: 1, e: "É proibido, a menos que o cliente assine um termo expresso de desenquadramento." },
            { m: "M3", q: "A comunicação com o cliente deve ser:", o: ["Técnica e complexa", "Clara e transparente", "Rápida e superficial", "Apenas escrita"], a: 1, e: "O cliente deve entender exatamente o que está comprando e seus riscos." },
            { m: "M3", q: "A prevenção à lavagem de dinheiro visa:", o: ["Aumentar lucros", "Controlar impostos", "Evitar uso do sistema para crimes", "Reduzir custos"], a: 2, e: "Evitar que dinheiro de origem ilícita (tráfico, corrupção) entre na economia formal." },
            { m: "M3", q: "O relacionamento com o cliente deve ser baseado em:", o: ["Pressão comercial", "Confiança e transparência", "Rentabilidade imediata", "Volume"], a: 1, e: "Relacionamento de longo prazo se constrói com confiança." },

            // MÓDULO 3 (NOVAS)
            { m: "M3", q: "Suitability exige que o profissional:", o: ["Venda o produto mais rentável", "Adeque produto ao perfil do cliente", "Priorize metas comerciais", "Ignore riscos"], a: 1, e: "Vender o produto adequado ao perfil de risco." },
            { m: "M3", q: "Um cliente conservador deve evitar:", o: ["CDB", "Tesouro Selic", "Ações", "LCI"], a: 2, e: "Ações têm alto risco de mercado." },
            { m: "M3", q: "KYC tem como objetivo:", o: ["Aumentar vendas", "Conhecer o cliente", "Reduzir custos", "Facilitar crédito"], a: 1, e: "Know Your Client: prevenir lavagem de dinheiro." },
            { m: "M3", q: "Detectar operações atípicas faz parte da:", o: ["Ética profissional", "Prevenção à lavagem de dinheiro", "Política monetária", "Autorregulação"], a: 1, e: "Monitoramento de PLD/FT." },
            { m: "M3", q: "O interesse do cliente deve prevalecer sobre:", o: ["Normas", "Rentabilidade", "Comissão do profissional", "Transparência"], a: 2, e: "Conflito de interesses: cliente vem antes da comissão." },
            { m: "M3", q: "Uma recomendação inadequada pode gerar:", o: ["Benefício ao cliente", "Penalidades ao profissional", "Maior rentabilidade", "Nenhuma consequência"], a: 1, e: "Punições administrativas e perda de credibilidade." },
            { m: "M3", q: "Comunicação eficiente é aquela que é:", o: ["Técnica", "Complexa", "Clara e adequada", "Rápida"], a: 2, e: "O cliente precisa entender." },
            { m: "M3", q: "Planejamento financeiro inclui:", o: ["Apenas investimentos", "Apenas previdência", "Orçamento, objetivos e investimentos", "Crédito bancário"], a: 2, e: "Visão global das finanças." },
            { m: "M3", q: "Ética no mercado financeiro exige:", o: ["Sigilo parcial", "Informação clara sobre riscos", "Venda agressiva", "Prioridade ao banco"], a: 1, e: "Transparência total." },
            { m: "M3", q: "O perfil do cliente deve ser atualizado:", o: ["Nunca", "Apenas no primeiro atendimento", "Periodicamente", "Somente se houver prejuízo"], a: 2, e: "A vida e os objetivos mudam." },


            // MÓDULO 4 (Existentes)
            { m: "M4", q: "Open Finance permite:", o: ["Compartilhar dados sem consentimento", "Compartilhar dados com autorização", "Uso exclusivo de bancos", "Apenas dados de investimentos"], a: 1, e: "A chave é o CONSENTIMENTO do cliente." },
            { m: "M4", q: "Fintechs são:", o: ["Bancos públicos", "Empresas tradicionais", "Empresas de tecnologia financeira", "Órgãos reguladores"], a: 2, e: "Technology + Finance. Startups que inovam no setor." },
            { m: "M4", q: "ESG refere-se a critérios:", o: ["Econômicos", "Tecnológicos", "Ambientais, Sociais e Governança", "Financeiros"], a: 2, e: "Environmental, Social, Governance." },
            { m: "M4", q: "A digitalização no mercado financeiro busca:", o: ["Reduzir concorrência", "Melhorar experiência do cliente", "Aumentar burocracia", "Eliminar atendimento"], a: 1, e: "Foco na usabilidade, agilidade e custo menor." },
            { m: "M4", q: "O uso de dados no mercado financeiro permite:", o: ["Decisões aleatórias", "Personalização de produtos", "Menos controle", "Exclusão financeira"], a: 1, e: "Com mais dados, o banco oferece exatamente o que você precisa (Hiperpersonalização)." },

            // MÓDULO 4 (NOVAS)
            { m: "M4", q: "Open Finance depende de:", o: ["Decisão do banco", "Autorização do cliente", "Regulador", "Governo"], a: 1, e: "Consentimento é a base." },
            { m: "M4", q: "Fintechs se destacam por:", o: ["Burocracia", "Uso intensivo de tecnologia", "Atuação estatal", "Exclusividade bancária"], a: 1, e: "Inovação tecnológica." },
            { m: "M4", q: "ESG influencia:", o: ["Apenas rentabilidade", "Apenas risco", "Decisões de investimento", "Política monetária"], a: 2, e: "Critérios socioambientais pesam na escolha." },
            { m: "M4", q: "Investimentos sustentáveis buscam:", o: ["Lucro imediato", "Impacto positivo e retorno financeiro", "Isenção fiscal", "Segurança absoluta"], a: 1, e: "Retorno + Propósito." },
            { m: "M4", q: "Big Data no mercado financeiro permite:", o: ["Decisões genéricas", "Produtos personalizados", "Menor controle", "Exclusão digital"], a: 1, e: "Análise de dados para ofertas sob medida." },


            // GERAIS (Existentes)
            { m: "Geral", q: "Produto mais indicado para cliente conservador:", o: ["Ações", "ETF", "CDB ou Tesouro Selic", "Fundo de ações"], a: 2, e: "Baixo risco e alta previsibilidade." },
            { m: "Geral", q: "Maior risco geralmente está associado a:", o: ["Renda fixa", "Curto prazo", "Renda variável", "FGC"], a: 2, e: "Renda Variável não tem garantia de retorno nem do principal." },
            { m: "Geral", q: "A autorregulação da ANBIMA tem como objetivo:", o: ["Substituir o BACEN", "Aumentar impostos", "Elevar padrões de mercado", "Controlar juros"], a: 2, e: "Criar um mercado mais forte, transparente e ético." },
            { m: "Geral", q: "A liquidez de um investimento representa:", o: ["Rentabilidade", "Segurança", "Facilidade de resgate", "Tributação"], a: 2, e: "Velocidade em transformar o ativo em dinheiro na conta." },
            { m: "Geral", q: "O profissional certificado deve sempre:", o: ["Priorizar metas internas", "Priorizar o cliente e agir com ética", "Oferecer o produto mais caro", "Evitar riscos"], a: 1, e: "O cliente vem em primeiro lugar. Sempre." },

            // GERAIS (NOVAS)
            { m: "Geral", q: "Um cliente conservador com reserva de emergência deve priorizar:", o: ["Ações", "Multimercado", "Tesouro Selic", "Debêntures"], a: 2, e: "Segurança e liquidez." },
            { m: "Geral", q: "Quanto maior o risco, maior tende a ser:", o: ["A garantia", "A liquidez", "O retorno esperado", "A previsibilidade"], a: 2, e: "Relação Risco x Retorno." },
            { m: "Geral", q: "Autorregulação da ANBIMA visa:", o: ["Punir investidores", "Aumentar impostos", "Boas práticas de mercado", "Substituir o BACEN"], a: 2, e: "Elevar o padrão do mercado." },
            { m: "Geral", q: "Liquidez diária significa:", o: ["Rentabilidade fixa", "Resgate rápido", "Isenção de IR", "Baixo risco"], a: 1, e: "Dinheiro na mão em D+0 ou D+1." },
            { m: "Geral", q: "O profissional CPA deve sempre agir com:", o: ["Foco em vendas", "Ética e interesse do cliente", "Pressão comercial", "Sigilo opcional"], a: 1, e: "Postura ética é fundamental." }
        ];

        // --- ESTADO GLOBAL ---
        let currentTab = 'plano';
        let currentQuestionIdx = 0;
        let score = 0;
        let isAnswered = false;
        let selectedOptionIdx = null;

        // --- INICIALIZAÇÃO ---
        document.addEventListener('DOMContentLoaded', () => {
            renderTabs();
            renderContent();
            lucide.createIcons();
            
            setTimeout(() => {
                document.getElementById('study-tip').classList.remove('hidden');
            }, 3000);
        });

        // --- LÓGICA DE NAVEGAÇÃO ---
        function renderTabs() {
            const container = document.getElementById('tabs-container');
            container.innerHTML = '';
            
            Object.values(studyData).forEach(tab => {
                const isActive = tab.id === currentTab;
                const btn = document.createElement('button');
                
                let classes = "pb-3 text-sm font-bold whitespace-nowrap transition-all flex items-center gap-2 outline-none border-b-2 ";
                if (isActive) {
                    classes += `${tab.borderClass} ${tab.textClass}`;
                } else {
                    classes += "text-gray-400 border-transparent hover:text-gray-600 hover:border-gray-200";
                }
                
                btn.className = classes;
                btn.onclick = () => switchTab(tab.id);
                btn.innerHTML = `<i data-lucide="${tab.icon}" class="w-4 h-4"></i> ${tab.title}`;
                container.appendChild(btn);
            });
            lucide.createIcons();
        }

        function switchTab(tabId) {
            currentTab = tabId;
            renderTabs();
            renderContent();
        }

        // --- LÓGICA DE CONTEÚDO ---
        function renderContent() {
            const main = document.getElementById('main-content');
            const data = studyData[currentTab];
            
            // Título da Seção
            let html = `
                <div class="mb-8 animate-fadeIn">
                    <h2 class="text-2xl font-bold text-gray-800 mb-1 flex items-center gap-2">
                        <span class="p-2 rounded-lg ${data.color} text-white"><i data-lucide="${data.icon}"></i></span>
                        ${data.title}
                    </h2>
                    <p class="text-sm text-gray-500 ml-12">Focado na Nova Certificação Base 2026</p>
                </div>
            `;

            // Plano de Estudos
            if (data.isPlan) {
                html += `<div class="animate-fadeIn relative border-l-2 border-gray-200 ml-4 space-y-8">`;
                data.steps.forEach((step, idx) => {
                    html += `
                    <div class="mind-map-node ml-6 bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow">
                        <div class="absolute -left-[31px] top-5 w-4 h-4 rounded-full bg-gray-800 border-4 border-white shadow-sm"></div>
                        <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-2">
                            <span class="text-xs font-bold uppercase tracking-wider text-indigo-600 bg-indigo-50 px-2 py-1 rounded">Semana ${step.week}</span>
                            <span class="text-xs text-gray-400 font-medium mt-1 sm:mt-0">Fase ${idx + 1}</span>
                        </div>
                        <h3 class="text-lg font-bold text-gray-800 mb-1">${step.module}</h3>
                        <p class="text-sm text-gray-600 mb-3">${step.focus}</p>
                        <div class="text-xs bg-gray-50 p-2 rounded text-gray-500 flex items-center gap-2">
                            <i data-lucide="check-square" class="w-3 h-3 text-green-500"></i>
                            <strong>Prática:</strong> ${step.action}
                        </div>
                    </div>`;
                });
                html += `</div>`;
            } else {
                // Tópicos (Módulos)
                html += '<div class="animate-fadeIn grid gap-4">';
                data.topics.forEach((topic, idx) => {
                    const topicId = `topic-${idx}`;
                    let keywordsHtml = '';
                    if (topic.keywords) {
                        keywordsHtml = `<div class="flex flex-wrap gap-2 mb-3">
                            ${topic.keywords.map(k => `<span class="keyword-tag">${k}</span>`).join('')}
                        </div>`;
                    }
                    
                    // Case Prático
                    let caseHtml = '';
                    if (topic.practicalCase) {
                        caseHtml = `
                            <div class="mb-5 p-4 bg-indigo-50 rounded-xl border border-indigo-100 text-sm text-indigo-900 shadow-sm">
                                <strong class="flex items-center gap-2 mb-2 text-indigo-700 uppercase tracking-wide text-xs">
                                    <i data-lucide="briefcase" class="w-4 h-4"></i> Case Prático
                                </strong>
                                <p class="leading-relaxed">${topic.practicalCase}</p>
                            </div>`;
                    }

                    let detailsHtml = '<div class="grid gap-3 mt-4">';
                    topic.details.forEach(d => {
                        detailsHtml += `
                            <div class="bg-gray-50 p-3 rounded-lg border border-gray-100">
                                <span class="text-xs font-bold text-gray-500 uppercase block mb-1">${d.label}</span>
                                <span class="text-sm text-gray-800 font-medium leading-snug">${d.value}</span>
                            </div>`;
                    });
                    detailsHtml += '</div>';

                    let subTopicsHtml = '';
                    if (topic.subTopics) {
                        subTopicsHtml = '<div class="mt-4 space-y-2">';
                        topic.subTopics.forEach(sub => {
                            subTopicsHtml += `
                                <div class="flex gap-3 items-start p-2 hover:bg-gray-50 rounded transition-colors">
                                    <div class="mt-1 min-w-[6px] h-[6px] rounded-full ${data.color}"></div>
                                    <div>
                                        <strong class="text-sm text-gray-800 block">${sub.name}</strong>
                                        <span class="text-xs text-gray-600">${sub.text}</span>
                                    </div>
                                </div>`;
                        });
                        subTopicsHtml += '</div>';
                    }

                    html += `
                    <div class="bg-white rounded-xl border border-gray-200 overflow-hidden transition-all hover:shadow-lg hover:border-indigo-100 group">
                        <button onclick="toggleCard('${topicId}')" class="w-full text-left p-5 flex items-start justify-between cursor-pointer">
                            <div>
                                <h3 class="font-bold text-gray-800 text-lg group-hover:text-indigo-600 transition-colors">${topic.title}</h3>
                                <p class="text-sm text-gray-500 mt-1 line-clamp-2">${topic.description}</p>
                            </div>
                            <div class="bg-gray-100 p-2 rounded-full group-hover:bg-indigo-50 transition-colors mt-1">
                                <i id="icon-${topicId}" data-lucide="chevron-down" class="w-5 h-5 text-gray-400 group-hover:text-indigo-600 transition-transform"></i>
                            </div>
                        </button>
                        <div id="${topicId}" class="hidden px-5 pb-5 border-t border-gray-100 pt-4 animate-fadeIn">
                            ${keywordsHtml}
                            <p class="text-sm text-gray-700 italic border-l-4 ${data.borderClass} pl-3 mb-4 py-1">"${topic.description}"</p>
                            ${caseHtml}
                            ${subTopicsHtml}
                            ${detailsHtml}
                        </div>
                    </div>`;
                });
                html += '</div>';
            }

            main.innerHTML = html;
            lucide.createIcons();
        }

        // --- UTILS ---
        function toggleCard(id) {
            const content = document.getElementById(id);
            const icon = document.getElementById(`icon-${id}`);
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // --- LÓGICA DO QUIZ (ATUALIZADA) ---
        function openQuiz() {
            document.getElementById('quiz-modal').classList.remove('hidden');
            resetQuiz();
        }

        function closeQuiz() {
            document.getElementById('quiz-modal').classList.add('hidden');
        }

        function resetQuiz() {
            currentQuestionIdx = 0;
            score = 0;
            isAnswered = false;
            selectedOptionIdx = null;
            renderQuestion();
        }

        function renderQuestion() {
            const body = document.getElementById('quiz-body');
            const footer = document.getElementById('quiz-footer');
            
            // Verifica Fim
            if (currentQuestionIdx >= quizQuestions.length) {
                renderResult();
                return;
            }

            const q = quizQuestions[currentQuestionIdx];

            // Renderiza Opções
            let optionsHtml = '<div class="grid gap-3 mt-4">';
            q.o.forEach((opt, idx) => {
                let classes = "w-full text-left p-4 rounded-xl border-2 transition-all flex items-center justify-between group relative ";
                let icon = '';

                if (isAnswered) {
                    if (idx === q.a) {
                        classes += "border-green-500 bg-green-50 text-green-900";
                        icon = '<i data-lucide="check-circle" class="text-green-600"></i>';
                    } else if (idx === selectedOptionIdx) {
                        classes += "border-red-300 bg-red-50 text-red-900";
                        icon = '<i data-lucide="x-circle" class="text-red-500"></i>';
                    } else {
                        classes += "border-gray-100 text-gray-400 opacity-50";
                    }
                } else {
                    classes += "border-gray-200 bg-white hover:border-indigo-400 hover:shadow-md text-gray-700 cursor-pointer";
                }

                const clickHandler = isAnswered ? '' : `onclick="handleAnswer(${idx})"`;

                optionsHtml += `
                    <button ${clickHandler} class="${classes}">
                        <span class="font-medium pr-6">${opt}</span>
                        ${icon}
                    </button>`;
            });
            optionsHtml += '</div>';

            // Explicação
            let explanationHtml = '';
            if (isAnswered) {
                const isCorrect = selectedOptionIdx === q.a;
                const feedbackColor = isCorrect ? "blue" : "amber";
                explanationHtml = `
                    <div class="mt-4 p-4 bg-${feedbackColor}-50 rounded-xl border border-${feedbackColor}-100 animate-fadeIn text-sm text-${feedbackColor}-900 shadow-sm">
                        <strong class="flex items-center gap-2 mb-1 text-${feedbackColor}-700">
                            <i data-lucide="${isCorrect ? 'thumbs-up' : 'lightbulb'}" class="w-4 h-4"></i> 
                            ${isCorrect ? 'Correto!' : 'Atenção!'}
                        </strong>
                        ${q.e}
                    </div>`;
            }

            // Corpo do Quiz
            body.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <span class="text-[10px] font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded uppercase tracking-wider border border-indigo-100">${q.m}</span>
                    <span class="text-xs text-gray-400 font-medium">Questão ${currentQuestionIdx + 1} de ${quizQuestions.length}</span>
                </div>
                <div class="h-1 w-full bg-gray-100 rounded-full mb-6 overflow-hidden">
                    <div class="h-full bg-indigo-500 transition-all duration-300" style="width: ${((currentQuestionIdx) / quizQuestions.length) * 100}%"></div>
                </div>
                <h4 class="text-lg font-bold text-gray-800 leading-snug">${q.q}</h4>
                ${optionsHtml}
                ${explanationHtml}
            `;

            // Footer
            if (isAnswered) {
                footer.innerHTML = `
                    <div class="text-sm font-bold text-gray-500">Acertos: <span class="text-indigo-600">${score}</span></div>
                    <button onclick="nextQuestion()" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-indigo-700 transition-colors flex items-center gap-2 shadow-lg shadow-indigo-200">
                        Próxima <i data-lucide="arrow-right" class="w-4 h-4"></i>
                    </button>`;
            } else {
                footer.innerHTML = `
                    <div class="text-sm font-bold text-gray-400">Escolha uma alternativa...</div>
                    <button disabled class="bg-gray-100 text-gray-300 px-6 py-3 rounded-lg font-bold cursor-not-allowed">
                        Próxima
                    </button>`;
            }
            lucide.createIcons();
        }

        function handleAnswer(idx) {
            if (isAnswered) return;
            isAnswered = true;
            selectedOptionIdx = idx;
            if (idx === quizQuestions[currentQuestionIdx].a) score++;
            renderQuestion(); // Re-renderiza para mostrar feedback
        }

        function nextQuestion() {
            currentQuestionIdx++;
            isAnswered = false;
            selectedOptionIdx = null;
            renderQuestion();
        }

        function renderResult() {
            const body = document.getElementById('quiz-body');
            const footer = document.getElementById('quiz-footer');
            footer.innerHTML = ''; // Limpa footer

            const percentage = Math.round((score / quizQuestions.length) * 100);
            let message = "";
            let color = "";
            
            if (percentage >= 70) {
                message = "Excelente! Você estaria APROVADO!";
                color = "text-green-600";
            } else if (percentage >= 50) {
                message = "Quase lá! Revise os pontos fracos.";
                color = "text-amber-600";
            } else {
                message = "Precisa estudar mais. Não desanime!";
                color = "text-red-600";
            }

            body.innerHTML = `
                <div class="text-center py-10 animate-fadeIn h-full flex flex-col justify-center items-center">
                    <div class="relative mb-6">
                        <div class="w-24 h-24 rounded-full border-8 border-gray-100 flex items-center justify-center">
                            <i data-lucide="trophy" class="w-10 h-10 text-indigo-200"></i>
                        </div>
                        <div class="absolute inset-0 w-24 h-24 rounded-full border-8 border-indigo-600 border-t-transparent animate-spin" style="animation-duration: 3s;"></div>
                        <div class="absolute inset-0 flex items-center justify-center font-black text-xl text-indigo-700">
                            ${percentage}%
                        </div>
                    </div>
                    
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Simulado Finalizado</h2>
                    <p class="text-gray-500 mb-8">Você acertou <strong class="text-indigo-600">${score}</strong> de <strong class="text-gray-800">${quizQuestions.length}</strong> questões.</p>
                    
                    <p class="text-lg font-bold ${color} mb-8 bg-gray-50 px-4 py-2 rounded-lg">${message}</p>
                    
                    <button onclick="resetQuiz()" class="bg-indigo-600 text-white px-8 py-3 rounded-full font-bold hover:bg-indigo-700 transition-colors flex items-center gap-2 shadow-xl">
                        <i data-lucide="rotate-ccw" class="w-4 h-4"></i> Refazer Simulado
                    </button>
                </div>
            `;
            lucide.createIcons();
        }

    </script>
</body>
</html>
