<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyBank ANBIMA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Animações e Scrollbar customizada */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out forwards;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans text-gray-900 selection:bg-blue-200">

    <!-- Header Fixo -->
    <header class="bg-white shadow-sm sticky top-0 z-20">
        <div class="max-w-3xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <i data-lucide="book-open" class="w-6 h-6 text-blue-600"></i>
                <h1 class="text-xl font-bold tracking-tight text-gray-800">
                    StudyBank <span class="text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full ml-1 align-top">ANBIMA</span>
                </h1>
            </div>
            <div class="text-xs text-gray-500 hidden sm:block">Material de Estudo</div>
        </div>
        
        <!-- Navegação Horizontal (Scrollable) -->
        <div class="max-w-3xl mx-auto px-4 pb-0 overflow-x-auto no-scrollbar">
            <div class="flex space-x-4 border-b border-gray-200" id="tabs-container">
                <!-- Abas geradas via JS -->
            </div>
        </div>
    </header>

    <!-- Conteúdo Principal -->
    <main class="max-w-3xl mx-auto p-4 pb-24" id="main-content">
        <!-- Conteúdo injetado via JS -->
    </main>

    <!-- Botão Flutuante (FAB) -->
    <div class="fixed bottom-6 right-6 z-40">
        <button onclick="openQuiz()" class="bg-blue-600 hover:bg-blue-700 text-white rounded-full px-6 py-4 shadow-lg transition-transform active:scale-95 flex items-center gap-2 font-bold cursor-pointer">
            <i data-lucide="check-circle" class="w-5 h-5"></i>
            <span>Praticar</span>
        </button>
    </div>

    <!-- Modal do Quiz -->
    <div id="quiz-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4 z-50 animate-fadeIn backdrop-blur-sm">
        <div class="bg-white rounded-xl max-w-lg w-full overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
            <!-- Header do Modal -->
            <div class="bg-blue-600 p-4 flex justify-between items-center text-white">
                <h3 class="font-bold text-lg flex items-center gap-2">
                    <i data-lucide="check-circle" class="w-5 h-5"></i>
                    Quiz Rápido
                </h3>
                <button onclick="closeQuiz()" class="hover:bg-blue-700 p-1 rounded-full transition-colors cursor-pointer">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>

            <!-- Corpo do Modal -->
            <div id="quiz-body" class="p-6 overflow-y-auto">
                <!-- Questões injetadas via JS -->
            </div>

            <!-- Footer do Modal -->
            <div id="quiz-footer" class="p-4 border-t border-gray-100 bg-gray-50 flex justify-end">
                <!-- Botão Próximo -->
            </div>
        </div>
    </div>

    <!-- Script Principal -->
    <script>
        // --- DADOS (Conteúdo e Quiz) ---
        const studyData = {
            rendaFixa: {
                id: "rendaFixa",
                title: "Renda Fixa",
                icon: "trending-up",
                color: "bg-blue-600",
                textClass: "text-blue-600",
                borderClass: "border-blue-600",
                topics: [
                    {
                        title: "Poupança",
                        description: "A aplicação mais tradicional do brasileiro. Funciona como um empréstimo simplificado ao banco.",
                        example: "Se você depositar R$ 1.000 hoje (dia 01), só receberá os juros se não sacar até o dia 01 do mês seguinte. Se sacar no dia 30, perde todo o rendimento do mês.",
                        details: [
                            { label: "Rendimento (Selic > 8,5%)", value: "0,5% ao mês + TR (Taxa Referencial)" },
                            { label: "Rendimento (Selic ≤ 8,5%)", value: "70% da Selic + TR" },
                            { label: "Risco", value: "Baixíssimo (Garantia do FGC até R$ 250 mil/CPF)" },
                            { label: "Liquidez", value: "Diária, mas com perda de rentabilidade se sacar antes do aniversário." },
                            { label: "IR", value: "Isento para Pessoa Física." }
                        ]
                    },
                    {
                        title: "CDB (Certificado de Depósito Bancário)",
                        description: "Você empresta dinheiro para o banco financiar as atividades dele. Em troca, recebe juros.",
                        example: "Você investe em um CDB que paga '110% do CDI'. Se o CDI anual for 10%, seu dinheiro renderá 11% bruto naquele ano.",
                        details: [
                            { label: "Rentabilidade", value: "Prefixada, Pós (CDI) ou Híbrida (IPCA+)" },
                            { label: "Risco", value: "Instituição financeira (FGC)" },
                            { label: "Liquidez", value: "Varia (Diária ou Vencimento)" },
                            { label: "IR", value: "Tabela Regressiva (22,5% a 15%)" }
                        ]
                    },
                    {
                        title: "RDB (Recibo de Depósito Bancário)",
                        description: "Muito parecido com o CDB. A diferença é que é inegociável e intransferível.",
                        example: "Você 'casa' com o título até o vencimento.",
                        details: [
                            { label: "Liquidez", value: "Somente no vencimento." },
                            { label: "Risco", value: "Banco emissor (FGC)." },
                            { label: "IR", value: "Tabela Regressiva." }
                        ]
                    },
                    {
                        title: "LCI & LCA (Letras de Crédito)",
                        description: "Títulos para financiar setores Imobiliário (LCI) e Agronegócio (LCA).",
                        example: "Isento de IR para incentivar esses setores estratégicos.",
                        details: [
                            { label: "Risco", value: "Banco emissor (FGC)" },
                            { label: "Carência", value: "Min 90 dias (LCI) / 9 meses (LCA)" },
                            { label: "Destaque", value: "ISENTO de IR para Pessoa Física." }
                        ]
                    },
                    {
                        title: "Debêntures",
                        description: "Títulos de dívida de EMPRESAS (não bancos) para financiar grandes projetos.",
                        example: "A Vale emite debêntures para construir uma ferrovia.",
                        details: [
                            { label: "Risco", value: "Crédito da Empresa (SEM FGC)" },
                            { label: "Rentabilidade", value: "Maior que bancários (prêmio de risco)" },
                            { label: "Incentivada", value: "Isenta de IR (Infraestrutura)" },
                            { label: "Comum", value: "Tabela regressiva" }
                        ]
                    },
                    {
                        title: "Títulos Públicos (Tesouro Direto)",
                        description: "Empréstimo ao Governo Federal. Investimento 'livre de risco' (soberano).",
                        subTopics: [
                            { name: "Tesouro Selic", text: "Pós-fixado. Baixa volatilidade. Ideal para Reserva de Emergência." },
                            { name: "Tesouro Prefixado", text: "Taxa fixa. Risco de Marcação a Mercado se vender antes." },
                            { name: "Tesouro IPCA+", text: "Garante juro real (acima da inflação). Longo prazo." }
                        ],
                        details: [
                            { label: "Liquidez", value: "D+1" },
                            { label: "IR", value: "Tabela Regressiva" }
                        ]
                    }
                ]
            },
            fundos: {
                id: "fundos",
                title: "Fundos",
                icon: "pie-chart",
                color: "bg-purple-600",
                textClass: "text-purple-600",
                borderClass: "border-purple-600",
                topics: [
                    {
                        title: "Fundo de Renda Fixa",
                        description: "Gestor compra cesta de títulos (CDBs, Tesouro).",
                        example: "Fundo DI compra 95% de Tesouro Selic.",
                        details: [
                            { label: "Tributação", value: "Come-cotas (Maio/Nov) + Regressiva" }
                        ]
                    },
                    {
                        title: "Fundo Multimercado",
                        description: "Liberdade para investir em Renda Fixa, Ações, Dólar e Derivativos.",
                        example: "Estratégias mistas para ganhar em vários cenários.",
                        details: [
                            { label: "Risco", value: "Médio a Alto" },
                            { label: "IR", value: "Regressiva + Come-cotas" }
                        ]
                    },
                    {
                        title: "Fundo de Ações (FIA)",
                        description: "Mínimo 67% em ações.",
                        example: "Carteira com ações da Petrobras, Itaú, etc.",
                        details: [
                            { label: "IR", value: "15% no resgate (SEM Come-cotas)" }
                        ]
                    },
                    {
                        title: "Fundo Cambial",
                        description: "Mínimo 80% em ativos atrelados a moeda estrangeira.",
                        example: "Proteção (Hedge) contra alta do dólar.",
                        details: [
                            { label: "Risco", value: "Oscilação da moeda" },
                            { label: "IR", value: "Regressiva + Come-cotas" }
                        ]
                    },
                    {
                        title: "Fundo Imobiliário (FII)",
                        description: "Negociado em bolsa. Investe em imóveis ou papéis imobiliários.",
                        example: "Recebe aluguéis mensais isentos de IR.",
                        details: [
                            { label: "Rendimentos", value: "Isentos para PF" },
                            { label: "Venda da cota", value: "20% de IR sobre lucro" }
                        ]
                    }
                ]
            },
            rendaVariavel: {
                id: "rendaVariavel",
                title: "Variável",
                icon: "trending-up",
                color: "bg-green-600",
                textClass: "text-green-600",
                borderClass: "border-green-600",
                topics: [
                    {
                        title: "Ações",
                        description: "Menor parcela do capital de uma S.A.",
                        example: "Sócio da empresa. Ganha com valorização e dividendos.",
                        details: [
                            { label: "ON", value: "Dá voto" },
                            { label: "PN", value: "Preferência nos dividendos" },
                            { label: "Swing Trade", value: "Isento até 20k vendas/mês" },
                            { label: "Day Trade", value: "20% de IR (sem isenção)" }
                        ]
                    },
                    {
                        title: "ETFs (Índice)",
                        description: "Fundos que copiam um índice (Ibovespa, S&P500).",
                        example: "BOVA11 (Ibovespa).",
                        details: [
                            { label: "Gestão", value: "Passiva" },
                            { label: "IR", value: "15% sobre ganho (SEM isenção de 20k)" }
                        ]
                    }
                ]
            },
            previdencia: {
                id: "previdencia",
                title: "Previdência",
                icon: "shield",
                color: "bg-orange-600",
                textClass: "text-orange-600",
                borderClass: "border-orange-600",
                topics: [
                    {
                        title: "PGBL",
                        description: "Para quem declara IR Completo.",
                        example: "Deduz até 12% da renda tributável anual.",
                        details: [
                            { label: "IR no Resgate", value: "Sobre o TOTAL (Principal + Juros)" }
                        ]
                    },
                    {
                        title: "VGBL",
                        description: "Para declaração Simplificada/Isento.",
                        example: "Planejamento sucessório.",
                        details: [
                            { label: "IR no Resgate", value: "Apenas sobre RENDIMENTOS" }
                        ]
                    }
                ]
            },
            glossario: {
                id: "glossario",
                title: "Glossário",
                icon: "help-circle",
                color: "bg-teal-600",
                textClass: "text-teal-600",
                borderClass: "border-teal-600",
                topics: [
                    {
                        title: "Selic",
                        description: "Taxa básica de juros, definida pelo BC.",
                        example: "Controla a inflação. Baliza Poupança e CDBs.",
                        details: [{ label: "Função", value: "Controle de inflação" }]
                    },
                    {
                        title: "CDI",
                        description: "Taxa de empréstimos entre bancos (1 dia).",
                        example: "Anda colado na Selic. Benchmark da Renda Fixa.",
                        details: [{ label: "Uso", value: "Meta de rentabilidade (Ex: 100% CDI)" }]
                    },
                    {
                        title: "TR (Taxa Referencial)",
                        description: "Corrige Poupança e FGTS.",
                        example: "Geralmente próxima de zero.",
                        details: [{ label: "Uso", value: "Rendimento Poupança" }]
                    },
                    {
                        title: "IPCA",
                        description: "Índice oficial de inflação.",
                        example: "Mede custo de vida.",
                        details: [{ label: "Meta", value: "Ganho Real = Rentabilidade - IPCA" }]
                    },
                    {
                        title: "FGC",
                        description: "Seguro do investidor contra quebra de banco.",
                        example: "Garante até R$ 250 mil por CPF/Instituição.",
                        details: [{ label: "Cobre", value: "CDB, LCI, LCA, Poupança" }]
                    },
                    {
                        title: "Come-Cotas",
                        description: "Antecipação de IR (Maio/Nov) em fundos.",
                        example: "Reduz o número de cotas que você possui.",
                        details: [{ label: "Isentos", value: "Fundo de Ações, Previdência" }]
                    }
                ]
            },
            novaCpa: {
                id: "novaCpa",
                title: "Nova CPA",
                icon: "award",
                color: "bg-indigo-700",
                textClass: "text-indigo-700",
                borderClass: "border-indigo-700",
                isSpecial: true
            }
        };

        const quizQuestions = [
            {
                question: "Um investidor deseja isenção de IR e investir no setor imobiliário. Qual produto é o indicado?",
                options: ["CDB", "LCI", "Tesouro IPCA+", "Debênture Comum"],
                answer: 1,
                explanation: "A LCI (Letra de Crédito Imobiliário) é isenta de IR para PF e financia o setor de imóveis."
            },
            {
                question: "Qual o limite de cobertura do FGC por CPF e instituição?",
                options: ["R$ 1 milhão", "R$ 500 mil", "R$ 250 mil", "Ilimitado"],
                answer: 2,
                explanation: "O FGC garante até R$ 250 mil por CPF e por instituição financeira."
            },
            {
                question: "Qual título público é indicado para Reserva de Emergência?",
                options: ["Tesouro Prefixado", "Tesouro IPCA+", "Tesouro Selic", "Debênture"],
                answer: 2,
                explanation: "O Tesouro Selic tem baixa volatilidade e liquidez diária."
            },
            {
                question: "O CDI costuma andar muito próximo de qual outra taxa?",
                options: ["IPCA", "Selic", "TR", "Dólar"],
                answer: 1,
                explanation: "O CDI rende aproximadamente 0,10 ponto percentual abaixo da Selic Meta."
            },
            {
                question: "No PGBL, o IR no resgate incide sobre:",
                options: ["Apenas rendimentos", "Valor total (capital + rendimento)", "Apenas capital", "Isento"],
                answer: 1,
                explanation: "No PGBL deduz na entrada, mas paga sobre TUDO na saída. VGBL é só sobre rendimento."
            },
            {
                question: "Fundo com objetivo de proteção cambial deve ter min 80% em:",
                options: ["Ações", "Moedas estrangeiras", "CDI", "Imóveis"],
                answer: 1,
                explanation: "Fundos Cambiais focam em variação de moeda (dólar/euro)."
            },
            {
                question: "Fundo de Ações deve ter no mínimo quanto em ações?",
                options: ["50%", "67%", "95%", "80%"],
                answer: 1,
                explanation: "Regulação exige mínimo de 67% (dois terços) em ações."
            }
        ];

        // --- ESTADO GLOBAL ---
        let currentTab = 'rendaFixa';
        let currentQuestionIdx = 0;
        let score = 0;
        let isAnswered = false;
        let selectedOptionIdx = null;

        // --- INICIALIZAÇÃO ---
        document.addEventListener('DOMContentLoaded', () => {
            renderTabs();
            renderContent();
            lucide.createIcons();
        });

        // --- LÓGICA DE NAVEGAÇÃO ---
        function renderTabs() {
            const container = document.getElementById('tabs-container');
            container.innerHTML = '';
            
            Object.values(studyData).forEach(tab => {
                const isActive = tab.id === currentTab;
                const btn = document.createElement('button');
                // Estilo base
                let classes = "pb-3 text-sm font-medium whitespace-nowrap transition-colors flex items-center gap-2 outline-none ";
                // Estilo ativo/inativo
                if (isActive) {
                    classes += `border-b-2 ${tab.borderClass} text-gray-900`;
                } else {
                    classes += "text-gray-500 hover:text-gray-700 border-b-2 border-transparent";
                }
                btn.className = classes;
                btn.onclick = () => switchTab(tab.id);
                btn.innerHTML = `<i data-lucide="${tab.icon}" class="w-4 h-4"></i> ${tab.title}`;
                container.appendChild(btn);
            });
            lucide.createIcons();
        }

        function switchTab(tabId) {
            currentTab = tabId;
            renderTabs();
            renderContent();
        }

        // --- LÓGICA DE CONTEÚDO ---
        function renderContent() {
            const main = document.getElementById('main-content');
            const data = studyData[currentTab];
            
            // Header da seção
            let html = `
                <div class="mb-6 animate-fadeIn">
                    <h2 class="text-2xl font-bold text-gray-800 mb-1">${data.title}</h2>
                    <p class="text-sm text-gray-500">${data.isSpecial ? 'Informações oficiais.' : 'Toque nos cartões para ver detalhes.'}</p>
                </div>
            `;

            // Conteúdo Especial (Nova CPA)
            if (data.isSpecial) {
                html += `
                <div class="animate-fadeIn space-y-6">
                    <div class="bg-indigo-50 p-4 rounded-lg border-l-4 border-indigo-700">
                        <h3 class="font-bold text-lg text-indigo-900 mb-2">Resumo da Mudança (Vigência Jan/2026)</h3>
                        <p class="text-indigo-800 text-sm">As antigas certificações (CPA-10, CPA-20 e CEA) dão lugar a uma <strong>estrutura em Y</strong>.</p>
                    </div>
                    <div class="grid gap-4 md:grid-cols-3">
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="flex items-center gap-2 mb-2"><span class="w-8 h-8 rounded-full bg-blue-100 text-blue-800 flex items-center justify-center font-bold text-sm">1</span><h4 class="font-bold text-gray-800">CPA</h4></div>
                            <p class="text-sm text-gray-600">Substitui a CPA-10. Entrada.</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="flex items-center gap-2 mb-2"><span class="w-8 h-8 rounded-full bg-green-100 text-green-800 flex items-center justify-center font-bold text-sm">2</span><h4 class="font-bold text-gray-800">C-Pro R</h4></div>
                            <p class="text-sm text-gray-600">Foco em <strong>Relacionamento</strong> (Antiga CPA-20).</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <div class="flex items-center gap-2 mb-2"><span class="w-8 h-8 rounded-full bg-purple-100 text-purple-800 flex items-center justify-center font-bold text-sm">3</span><h4 class="font-bold text-gray-800">C-Pro I</h4></div>
                            <p class="text-sm text-gray-600">Foco em <strong>Investimentos</strong> (Antigo CEA).</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <h4 class="font-bold text-gray-800 flex items-center gap-2"><i data-lucide="alert-triangle" class="w-5 h-5 text-amber-500"></i> Regras de Transição</h4>
                        <ul class="list-disc pl-5 space-y-2 text-sm text-gray-700">
                            <li><strong>Em Transição:</strong> Quem já tem certificação pode trabalhar normalmente em 2026.</li>
                            <li><strong>Migração:</strong> Feita via cursos na ANBIMA Edu (não precisa refazer prova).</li>
                            <li><strong>CPA-10</strong> ➝ CPA.</li>
                            <li><strong>CPA-20</strong> ➝ CPA + C-Pro R.</li>
                            <li><strong>CEA</strong> ➝ CPA + C-Pro R + C-Pro I.</li>
                        </ul>
                    </div>
                </div>`;
            } else {
                // Lista de Cartões
                html += '<div class="animate-fadeIn space-y-4">';
                data.topics.forEach((topic, idx) => {
                    // ID único para o acordeão
                    const topicId = `topic-${idx}`;
                    
                    // Renderiza sub-topicos se houver
                    let subTopicsHtml = '';
                    if (topic.subTopics) {
                        subTopicsHtml = '<div class="mb-4 grid gap-2">';
                        topic.subTopics.forEach(sub => {
                            subTopicsHtml += `
                                <div class="bg-blue-50 p-3 rounded-lg border border-blue-100">
                                    <span class="font-bold text-blue-900 block text-sm mb-1">${sub.name}</span>
                                    <span class="text-xs text-blue-800 leading-snug block">${sub.text}</span>
                                </div>`;
                        });
                        subTopicsHtml += '</div>';
                    }

                    // Renderiza detalhes
                    let detailsHtml = '<div class="space-y-2 mt-2 border-t border-gray-100 pt-3">';
                    topic.details.forEach(d => {
                        detailsHtml += `
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center text-sm border-b border-gray-50 pb-2 last:border-0 last:pb-0 gap-1">
                                <span class="font-semibold text-gray-700">${d.label}:</span>
                                <span class="text-gray-600 sm:text-right">${d.value}</span>
                            </div>`;
                    });
                    detailsHtml += '</div>';

                    // Exemplo prático
                    let exampleHtml = '';
                    if (topic.example) {
                        exampleHtml = `
                            <div class="mb-4 p-3 bg-gray-50 rounded-lg border border-gray-100 text-sm text-gray-700">
                                <strong class="block text-gray-900 mb-1 flex items-center gap-1">
                                    <i data-lucide="info" class="w-3 h-3 text-blue-500"></i> Exemplo:
                                </strong>
                                ${topic.example}
                            </div>`;
                    }

                    html += `
                    <div class="border border-gray-200 rounded-xl overflow-hidden bg-white shadow-sm hover:shadow-md transition-shadow">
                        <button onclick="toggleCard('${topicId}')" class="w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 transition-colors text-left group">
                            <div class="flex items-center gap-3">
                                <div class="w-2 h-10 rounded-full ${data.color}"></div>
                                <div>
                                    <h3 class="font-bold text-gray-800 group-hover:text-blue-700 transition-colors">${topic.title}</h3>
                                    <p class="text-xs text-gray-500 line-clamp-1">${topic.description}</p>
                                </div>
                            </div>
                            <i id="icon-${topicId}" data-lucide="chevron-right" class="text-gray-400 transition-transform duration-200"></i>
                        </button>
                        <div id="${topicId}" class="hidden p-4 bg-white">
                            <div class="mb-4 text-sm text-gray-600 leading-relaxed">${topic.description}</div>
                            ${exampleHtml}
                            ${subTopicsHtml}
                            ${detailsHtml}
                        </div>
                    </div>`;
                });
                html += '</div>';
            }

            main.innerHTML = html;
            lucide.createIcons();
        }

        // --- LÓGICA DE ACORDEÃO ---
        function toggleCard(id) {
            const content = document.getElementById(id);
            const icon = document.getElementById(`icon-${id}`);
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                // Rotacionar icone manualmente trocando classe ou SVG, mas aqui vamos re-renderizar o ícone ou usar css transform
                // Simplificando com classes do lucide
                icon.innerHTML = '<polyline points="6 9 12 15 18 9"></polyline>'; // Chevron Down SVG path
            } else {
                content.classList.add('hidden');
                icon.innerHTML = '<polyline points="9 18 15 12 9 6"></polyline>'; // Chevron Right SVG path
            }
            // Recriar o SVG pq alteramos o innerHTML manualmente
            lucide.createIcons();
        }

        // --- LÓGICA DO QUIZ ---
        function openQuiz() {
            document.getElementById('quiz-modal').classList.remove('hidden');
            resetQuiz();
        }

        function closeQuiz() {
            document.getElementById('quiz-modal').classList.add('hidden');
        }

        function resetQuiz() {
            currentQuestionIdx = 0;
            score = 0;
            resetQuestionState();
            renderQuestion();
        }

        function resetQuestionState() {
            isAnswered = false;
            selectedOptionIdx = null;
        }

        function renderQuestion() {
            const container = document.getElementById('quiz-body');
            const footer = document.getElementById('quiz-footer');
            
            // Verifica se acabou
            if (currentQuestionIdx >= quizQuestions.length) {
                renderResult();
                return;
            }

            const q = quizQuestions[currentQuestionIdx];

            // Renderiza Opções
            let optionsHtml = '<div class="space-y-3 mt-6">';
            q.options.forEach((opt, idx) => {
                let btnClass = "w-full text-left p-4 rounded-lg border-2 transition-all flex justify-between items-center ";
                let iconHtml = '';

                if (isAnswered) {
                    if (idx === q.answer) {
                        btnClass += "border-green-500 bg-green-50 text-green-900";
                        iconHtml = '<i data-lucide="check-circle" class="w-5 h-5 text-green-600"></i>';
                    } else if (idx === selectedOptionIdx) {
                        btnClass += "border-red-300 bg-red-50 text-red-900";
                        iconHtml = '<i data-lucide="alert-triangle" class="w-5 h-5 text-red-500"></i>';
                    } else {
                        btnClass += "border-gray-100 text-gray-400 opacity-50";
                    }
                } else {
                    btnClass += "border-gray-200 hover:border-blue-300 hover:bg-blue-50 text-gray-700 cursor-pointer";
                }

                // Desabilita clique se respondido
                const onClickAttr = isAnswered ? '' : `onclick="handleAnswer(${idx})"`;

                optionsHtml += `
                    <button ${onClickAttr} class="${btnClass}">
                        <span>${opt}</span>
                        ${iconHtml}
                    </button>
                `;
            });
            optionsHtml += '</div>';

            // Explicação
            let explanationHtml = '';
            if (isAnswered) {
                explanationHtml = `
                    <div class="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200 animate-fadeIn">
                        <p class="text-sm text-gray-600"><span class="font-bold text-gray-800">Explicação:</span> ${q.explanation}</p>
                    </div>`;
            }

            // Monta o corpo
            container.innerHTML = `
                <div class="mb-4 flex justify-between text-xs text-gray-500 font-medium uppercase tracking-wider">
                    <span>Questão ${currentQuestionIdx + 1} de ${quizQuestions.length}</span>
                    <span>Pontos: ${score}</span>
                </div>
                <h4 class="text-lg font-bold text-gray-800">${q.question}</h4>
                ${optionsHtml}
                ${explanationHtml}
            `;

            // Footer Button
            if (isAnswered) {
                footer.innerHTML = `
                    <button onclick="nextQuestion()" class="flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-bold shadow-sm hover:shadow-md transition-all">
                        ${currentQuestionIdx < quizQuestions.length - 1 ? 'Próxima' : 'Ver Resultado'} <i data-lucide="chevron-right" class="w-4 h-4"></i>
                    </button>
                `;
            } else {
                footer.innerHTML = `
                    <button disabled class="flex items-center gap-2 px-6 py-3 bg-gray-300 text-gray-500 rounded-lg font-bold cursor-not-allowed">
                        Próxima <i data-lucide="chevron-right" class="w-4 h-4"></i>
                    </button>
                `;
            }

            lucide.createIcons();
        }

        function handleAnswer(idx) {
            if (isAnswered) return;
            isAnswered = true;
            selectedOptionIdx = idx;
            
            if (idx === quizQuestions[currentQuestionIdx].answer) {
                score++;
            }
            renderQuestion(); // Re-renderiza para mostrar cores e feedback
        }

        function nextQuestion() {
            currentQuestionIdx++;
            resetQuestionState();
            renderQuestion();
        }

        function renderResult() {
            const container = document.getElementById('quiz-body');
            const footer = document.getElementById('quiz-footer');
            
            footer.innerHTML = ''; // Limpa footer

            container.innerHTML = `
                <div class="text-center py-8 animate-fadeIn">
                    <div class="flex justify-center mb-4">
                        <i data-lucide="award" class="w-16 h-16 text-yellow-500"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Quiz Finalizado!</h2>
                    <p class="text-gray-600 mb-8">Você acertou <strong class="text-blue-600 text-xl">${score}</strong> de <strong class="text-gray-800">${quizQuestions.length}</strong> questões.</p>
                    
                    <div class="flex flex-col sm:flex-row gap-3 justify-center">
                        <button onclick="resetQuiz()" class="flex items-center justify-center gap-2 px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 font-semibold transition-colors">
                            <i data-lucide="refresh-cw" class="w-4 h-4"></i> Tentar Novamente
                        </button>
                        <button onclick="closeQuiz()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold transition-colors shadow-lg">
                            Fechar
                        </button>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

    </script>
</body>
</html>
