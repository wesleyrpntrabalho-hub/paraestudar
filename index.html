<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova CPA 2026 - StudyBank</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out forwards;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .mind-map-node {
            position: relative;
        }
        .mind-map-node::before {
            content: '';
            position: absolute;
            left: -16px;
            top: 50%;
            width: 16px;
            height: 2px;
            background-color: #CBD5E1;
        }
        .keyword-tag {
            background-color: #FEF3C7;
            color: #92400E;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        /* Estilos para o conte√∫do rico */
        .rich-content h4 { font-weight: 800; color: #1e40af; margin-top: 1rem; margin-bottom: 0.5rem; font-size: 1rem; }
        .rich-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 0.5rem; }
        .rich-content li { margin-bottom: 0.25rem; }
        .rich-content strong { color: #374151; font-weight: 700; }
        .rich-content .alert-box { background-color: #FEF2F2; border-left: 4px solid #EF4444; padding: 0.75rem; border-radius: 0.25rem; margin: 1rem 0; font-size: 0.9em; color: #7F1D1D; }
        .rich-content .concept-box { background-color: #EFF6FF; border-left: 4px solid #3B82F6; padding: 0.75rem; border-radius: 0.25rem; margin: 1rem 0; font-size: 0.9em; color: #1E3A8A; }
        .rich-content .mnemo-box { background-color: #F0FDF4; border-left: 4px solid #22C55E; padding: 0.75rem; border-radius: 0.25rem; margin: 1rem 0; font-size: 0.9em; color: #14532D; font-family: monospace; }
        
        /* Tabela Customizada */
        .custom-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; margin-bottom: 1rem; }
        .custom-table th { background-color: #1e40af; color: white; padding: 8px; text-align: left; }
        .custom-table td { border: 1px solid #e5e7eb; padding: 8px; color: #374151; }
        .custom-table tr:nth-child(even) { background-color: #f9fafb; }

        /* Estilo Mapa Mental CSS */
        .tree ul { padding-top: 20px; position: relative; transition: all 0.5s; }
        .tree li { float: left; text-align: center; list-style-type: none; position: relative; padding: 20px 5px 0 5px; transition: all 0.5s; }
        .tree li::before, .tree li::after { content: ''; position: absolute; top: 0; right: 50%; border-top: 1px solid #ccc; width: 50%; height: 20px; }
        .tree li::after { right: auto; left: 50%; border-left: 1px solid #ccc; }
        .tree li:only-child::after, .tree li:only-child::before { display: none; }
        .tree li:only-child { padding-top: 0; }
        .tree li:first-child::before, .tree li:last-child::after { border: 0 none; }
        .tree li:last-child::before { border-right: 1px solid #ccc; border-radius: 0 5px 0 0; }
        .tree li:first-child::after { border-radius: 5px 0 0 0; }
        .tree ul ul::before { content: ''; position: absolute; top: 0; left: 50%; border-left: 1px solid #ccc; width: 0; height: 20px; }
        .tree-node { border: 1px solid #ccc; padding: 5px 10px; text-decoration: none; color: #666; font-family: arial, verdana, tahoma; font-size: 11px; display: inline-block; border-radius: 5px; transition: all 0.5s; background: white; }
        .tree-node.boss { background: #dbeafe; border-color: #2563eb; color: #1e40af; font-weight: bold; }
        .tree-node.exec { background: #f3f4f6; border-color: #9ca3af; }
        
        /* Quiz Tabs */
        .quiz-tab { @apply px-4 py-2 text-sm font-medium border-b-2 transition-colors cursor-pointer; }
        .quiz-tab.active { border-color: #4f46e5; color: #4f46e5; background-color: #eef2ff; }
        .quiz-tab.inactive { border-color: transparent; color: #6b7280; }
        .quiz-tab.inactive:hover { color: #374151; border-color: #d1d5db; }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-900 selection:bg-indigo-200">

    <!-- Header Fixo -->
    <header class="bg-white shadow-sm sticky top-0 z-20 border-b border-gray-100">
        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="bg-indigo-600 p-1.5 rounded-lg">
                    <i data-lucide="graduation-cap" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold tracking-tight text-gray-800 leading-none">
                        Nova CPA <span class="text-indigo-600">2026</span>
                    </h1>
                    <span class="text-[10px] font-semibold text-gray-400 uppercase tracking-wider">Certifica√ß√£o Base</span>
                </div>
            </div>
            <div class="hidden sm:flex items-center gap-4 text-xs font-medium text-gray-500">
                <span class="flex items-center gap-1"><i data-lucide="clock" class="w-3 h-3"></i> 6-8 Semanas</span>
                <span class="flex items-center gap-1"><i data-lucide="book" class="w-3 h-3"></i> 5 M√≥dulos</span>
            </div>
        </div>
        
        <!-- Navega√ß√£o Horizontal (Scrollable) -->
        <div class="max-w-4xl mx-auto px-4 pb-0 overflow-x-auto no-scrollbar bg-white">
            <div class="flex space-x-6 border-b border-gray-100" id="tabs-container">
                <!-- Abas geradas via JS -->
            </div>
        </div>
    </header>

    <!-- Conte√∫do Principal -->
    <main class="max-w-4xl mx-auto p-4 pb-32" id="main-content">
        <!-- Conte√∫do injetado via JS -->
    </main>

    <!-- Bot√£o Flutuante (FAB) -->
    <div class="fixed bottom-6 right-6 z-40 flex flex-col items-end gap-3">
        <div id="study-tip" class="hidden bg-white p-3 rounded-lg shadow-xl border border-gray-100 max-w-xs text-xs text-gray-600 animate-fadeIn mb-2 relative">
            <div class="absolute -bottom-2 right-6 w-4 h-4 bg-white transform rotate-45 border-b border-r border-gray-100"></div>
            <strong>Dica:</strong> Seu banco agora tem 100 quest√µes! Pratique.
        </div>
        <button onclick="openQuiz()" class="bg-indigo-600 hover:bg-indigo-700 text-white rounded-full px-6 py-4 shadow-lg shadow-indigo-200 transition-all active:scale-95 flex items-center gap-2 font-bold cursor-pointer group">
            <i data-lucide="brain-circuit" class="w-5 h-5 group-hover:rotate-12 transition-transform"></i>
            <span>Simulado</span>
        </button>
    </div>

    <!-- Modal do Quiz -->
    <div id="quiz-modal" class="fixed inset-0 bg-black/60 hidden flex items-center justify-center p-4 z-50 animate-fadeIn backdrop-blur-sm">
        <div class="bg-white rounded-2xl max-w-2xl w-full overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
            <!-- Header do Modal -->
            <div class="bg-indigo-600 p-5 pb-2 text-white">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="font-bold text-xl flex items-center gap-2">
                            <i data-lucide="check-circle-2" class="w-6 h-6"></i>
                            Simulado
                        </h3>
                        <div class="flex items-center gap-3 mt-1">
                            <span class="text-indigo-200 text-xs" id="question-count-badge">-- Quest√µes</span>
                            <span class="bg-indigo-700 px-2 py-0.5 rounded text-[10px] flex items-center gap-1 font-mono">
                                <i data-lucide="timer" class="w-3 h-3"></i> <span id="quiz-timer">00:00</span>
                            </span>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="restartQuiz()" class="hover:bg-indigo-700 p-2 rounded-full transition-colors cursor-pointer bg-indigo-500/30" title="Reiniciar do Zero">
                            <i data-lucide="rotate-ccw" class="w-5 h-5"></i>
                        </button>
                        <button onclick="closeQuiz()" class="hover:bg-indigo-700 p-2 rounded-full transition-colors cursor-pointer bg-indigo-500/30" title="Fechar e Salvar">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Abas do Simulado -->
                <div class="flex space-x-1 overflow-x-auto no-scrollbar pb-2" id="quiz-tabs-container">
                    <!-- Gerado via JS -->
                </div>
            </div>

            <!-- Corpo do Modal -->
            <div id="quiz-body" class="p-6 overflow-y-auto bg-gray-50 flex-1">
                <!-- Quest√µes injetadas via JS -->
            </div>

            <!-- Footer do Modal -->
            <div id="quiz-footer" class="p-4 border-t border-gray-100 bg-white flex justify-between items-center">
                <!-- Bot√µes e Progresso -->
            </div>
        </div>
    </div>

    <!-- Script Principal -->
    <script>
        // --- DADOS DO ESTUDO (NOVA CPA) ---
        // (O objeto studyData permanece o mesmo, contendo todos os m√≥dulos ricos e detalhados)
        const studyData = {
            plano: {
                id: "plano",
                title: "Plano de Estudos",
                icon: "calendar-clock",
                color: "bg-gray-800",
                textClass: "text-gray-800",
                borderClass: "border-gray-800",
                isPlan: true,
                steps: [
                    { week: "1-2", module: "M√≥dulo 1: SFN", focus: "Estrutura, √ìrg√£os (CMN, BC, CVM), Seguros (SUSEP, PREVIC) e Economia (PIB, IPCA).", action: "20-30 quest√µes por tema." },
                    { week: "3-5", module: "M√≥dulo 2: Produtos", focus: "Renda Fixa, Fundos, Vari√°vel, Previd√™ncia (O mais pesado!).", action: "Comparar risco x retorno x liquidez." },
                    { week: "6", module: "M√≥dulo 3: Clientes", focus: "Suitability, √âtica, PLD/FT.", action: "Foco em interpreta√ß√£o de texto." },
                    { week: "7", module: "M√≥dulo 4: Inova√ß√£o", focus: "ESG, Open Finance, Fintechs.", action: "Quest√µes conceituais." },
                    { week: "8", module: "Revis√£o Final", focus: "Simulados completos.", action: "Corrigir erros e reler resumos." }
                ]
            },
            resumos: {
                id: "resumos",
                title: "Resumos & Macetes",
                icon: "clipboard-list",
                color: "bg-pink-600",
                textClass: "text-pink-600",
                borderClass: "border-pink-600",
                topics: [
                    {
                        title: "Infraestrutura: Clearing Houses (C√¢maras)",
                        keywords: ["RISCO DE CONTRAPARTE", "SELIC", "B3", "GARANTIA"],
                        description: "Quem garante que quem comprou vai pagar e quem vendeu vai entregar? A Clearing.",
                        content: `
                            <h4>üîê O Conceito</h4>
                            <p>As <strong>Clearing Houses</strong> (C√¢maras de Compensa√ß√£o) atuam como a "Contraparte Central". Elas ficam entre o comprador e o vendedor, mitigando o <strong>Risco de Liquida√ß√£o</strong> (calote na entrega).</p>
                            <h4>üè¢ As Principais no Brasil</h4>
                            <ul>
                                <li><strong>Sistema SELIC (do Bacen):</strong> Liquida e custodia <strong>T√≠tulos P√∫blicos Federais</strong> (Tesouro Direto).</li>
                                <li><strong>B3 (Brasil, Bolsa, Balc√£o):</strong> Liquida e custodia ativos privados:
                                    <ul>
                                        <li>A√ß√µes (Mercado de Capitais).</li>
                                        <li>Derivativos.</li>
                                        <li>T√≠tulos Privados (CDB, Deb√™ntures, LCI/LCA).</li>
                                    </ul>
                                </li>
                            </ul>
                            <div class="concept-box">
                                <strong>Na pr√°tica:</strong> Quando voc√™ compra uma a√ß√£o, voc√™ n√£o transfere dinheiro para o vendedor (Jos√©). Voc√™ paga para a B3, e a B3 paga para o Jos√©. Se o Jos√© n√£o entregar a a√ß√£o, a B3 garante a entrega.
                            </div>
                        `,
                        practicalCase: "Voc√™ comprou um T√≠tulo P√∫blico no Tesouro Direto. Quem guarda esse registro eletr√¥nico ('anota√ß√£o em conta') √© o Sistema SELIC. Se voc√™ compra uma a√ß√£o da Petrobras, quem guarda √© a B3."
                    },
                    {
                        title: "Dicion√°rio Financeiro (Termos em Ingl√™s)",
                        keywords: ["COMPLIANCE", "DISCLOSURE", "SPREAD", "BENCHMARK"],
                        description: "O vocabul√°rio 'falah√™s' que cai na prova.",
                        content: `
                            <ul class="space-y-3">
                                <li><strong>Compliance (Conformidade):</strong> Estar de acordo com as leis e normas. O departamento que vigia se o banco est√° seguindo as regras.</li>
                                <li><strong>Disclosure (Divulga√ß√£o):</strong> Transpar√™ncia. O ato de divulgar informa√ß√µes relevantes (balan√ßos, fatos relevantes) ao mercado.</li>
                                <li><strong>Spread Banc√°rio:</strong> A diferen√ßa entre a taxa que o banco cobra de quem pede empr√©stimo e a taxa que ele paga para quem investe. (√â o lucro bruto do banco na opera√ß√£o).</li>
                                <li><strong>Benchmark (Refer√™ncia):</strong> √çndice usado como meta de desempenho.
                                    <br><em>Ex: Um fundo de a√ß√µes quer superar o Ibovespa (Benchmark). Um fundo de Renda Fixa quer superar o CDI.</em></li>
                                <li><strong>Default (Calote):</strong> O n√£o pagamento de uma obriga√ß√£o financeira.</li>
                                <li><strong>Holding:</strong> Empresa que n√£o produz nada, apenas det√©m a√ß√µes de outras empresas (controladora).</li>
                                <li><strong>Joint Venture:</strong> Parceria comercial entre duas empresas.</li>
                            </ul>
                        `
                    },
                    {
                        title: "Mapa Mental: SFN (Quem Manda em Quem)",
                        keywords: ["HIERARQUIA", "NORMATIVO", "SUPERVISOR"],
                        description: "Estrutura visual do sistema.",
                        content: `
                            <div class="overflow-x-auto pb-4">
                                <div class="tree w-[600px] mx-auto">
                                    <ul>
                                        <li>
                                            <a href="#" class="tree-node boss">CMN (Conselho Monet√°rio)</a>
                                            <ul>
                                                <li>
                                                    <a href="#" class="tree-node exec">BACEN (Banco Central)</a>
                                                    <ul>
                                                        <li><span class="tree-node">Bancos</span></li>
                                                        <li><span class="tree-node">Corretoras</span></li>
                                                    </ul>
                                                </li>
                                                <li>
                                                    <a href="#" class="tree-node exec">CVM (Valores Mobili√°rios)</a>
                                                    <ul>
                                                        <li><span class="tree-node">Bolsa (B3)</span></li>
                                                        <li><span class="tree-node">Fundos</span></li>
                                                    </ul>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="alert-box">
                                <strong>Regra:</strong> Quem tem "C" no come√ßo geralmente √© Conselho (Manda/Normativo). Quem tem "S" ou "B" √© Supervisor/Executor (Fiscaliza).
                            </div>
                        `
                    },
                    {
                        title: "Mnem√¥nicos Poderosos",
                        keywords: ["DECOREBA", "MACETES", "PROVA"],
                        description: "Frases para lembrar na hora do aperto.",
                        content: `
                            <h4>üèõÔ∏è √ìrg√£os do SFN</h4>
                            <div class="mnemo-box">CMN Manda, BACEN Executa.</div>
                            <div class="mnemo-box">Seguros Privados? SUSEP (S de Seguro).</div>
                            <div class="mnemo-box">Previd√™ncia de Empresa? PREVIC (Fechada).</div>
                            
                            <h4>üìâ Lavagem de Dinheiro (Fases)</h4>
                            <div class="mnemo-box">CO - O - I (Coloca√ß√£o, Oculta√ß√£o, Integra√ß√£o).</div>
                            
                            <h4>üè† IGP-M (Composi√ß√£o)</h4>
                            <div class="mnemo-box">60-30-10 (60% Atacado, 30% Consumidor, 10% Obra).</div>
                            
                            <h4>üê¢ Come-cotas</h4>
                            <div class="mnemo-box">Maio e Novembro (M.N. = M√≠nimo no bolso).</div>
                        `
                    },
                    {
                        title: "Conceitos Extras: Bolsa e √âtica",
                        keywords: ["CIRCUIT BREAKER", "INSIDER", "CHINESE WALL"],
                        description: "Termos que caem e n√£o estavam nos m√≥dulos principais.",
                        content: `
                            <h4>üõë Circuit Breaker (B3)</h4>
                            <p>Mecanismo de seguran√ßa que paralisa o preg√£o quando a bolsa cai muito r√°pido para "esfriar a cabe√ßa" dos investidores.</p>
                            <ul>
                                <li><strong>Queda de 10%:</strong> Para 30 min.</li>
                                <li><strong>Queda de 15%:</strong> Para 1 hora.</li>
                                <li><strong>Queda de 20%:</strong> Suspende por tempo indeterminado (decis√£o da B3).</li>
                            </ul>
                            
                            <h4>üïµÔ∏è Insider Trading vs Front Running</h4>
                            <ul>
                                <li><strong>Insider Trading (Informa√ß√£o Privilegiada):</strong> Algu√©m de DENTRO da empresa (diretor) usa uma informa√ß√£o que o mercado n√£o sabe para lucrar. (Ex: Sabe que o lucro ser√° recorde e compra a√ß√µes antes).</li>
                                <li><strong>Front Running (Passar na Frente):</strong> O CORRETOR sabe que um cliente vai fazer uma ordem gigante e compra antes dele para pegar a alta.</li>
                            </ul>

                            <h4>üß± Chinese Wall (Muralha da China)</h4>
                            <p>Segrega√ß√£o total de fun√ß√µes dentro de um banco. Quem gere o dinheiro dos clientes (Asset) n√£o pode falar com quem gere o dinheiro do pr√≥prio banco (Tesouraria) para evitar conflito de interesses.</p>
                        `
                    },
                    {
                        title: "Tabela Mestra de Tributa√ß√£o (IR)",
                        keywords: ["REGRESSIVA", "A√á√ïES", "ISENTOS", "COME-COTAS"],
                        description: "O guia definitivo para n√£o errar imposto na prova.",
                        content: `
                            <h4>üìâ Renda Fixa e Fundos (Regressiva)</h4>
                            <p>CDB, Tesouro, Deb√™nture Comum, Fundos RF/Multi/Cambial.</p>
                            <table class="custom-table">
                                <tr><th>Prazo</th><th>Al√≠quota</th></tr>
                                <tr><td>At√© 180 dias</td><td>22,5%</td></tr>
                                <tr><td>181 a 360 dias</td><td>20%</td></tr>
                                <tr><td>361 a 720 dias</td><td>17,5%</td></tr>
                                <tr><td>Acima de 720 dias</td><td>15%</td></tr>
                            </table>
                            
                            <h4>üìä Renda Vari√°vel (A√ß√µes/ETF)</h4>
                            <table class="custom-table">
                                <tr><th>Tipo</th><th>Al√≠quota</th><th>Reten√ß√£o (Dedo-duro)</th></tr>
                                <tr><td>Swing Trade</td><td>15% (Isento at√© 20k vendas/m√™s em a√ß√µes)</td><td>0,005%</td></tr>
                                <tr><td>Day Trade</td><td>20% (Sem isen√ß√£o)</td><td>1%</td></tr>
                                <tr><td>FII (Fundo Imob)</td><td>20% (Venda de cota)</td><td>0,005%</td></tr>
                            </table>

                            <h4>üê¢ Come-cotas (Fundos Abertos)</h4>
                            <p>Antecipa√ß√£o de IR em Maio e Novembro.</p>
                            <ul>
                                <li><strong>Curto Prazo:</strong> 20%</li>
                                <li><strong>Longo Prazo:</strong> 15%</li>
                                <li><strong>Fundo de A√ß√µes:</strong> N√ÉO TEM.</li>
                            </ul>
                        `,
                        details: [
                            { label: "IOF", value: "Cobrado apenas em resgates com menos de 30 dias (Tabela regressiva r√°pida de 96% a 0%)." }
                        ]
                    },
                    {
                        title: "SPB (Sistema de Pagamentos Brasileiro)",
                        keywords: ["RISCO SIST√äMICO", "TED", "PIX", "STR"],
                        description: "A infraestrutura invis√≠vel que move o dinheiro.",
                        content: `
                            <h4>üè¶ O que √©?</h4>
                            <p>Conjunto de regras e sistemas que garantem que, quando voc√™ faz uma transfer√™ncia, o dinheiro realmente saia do banco A e v√° para o banco B.</p>
                            <h4>üõ†Ô∏è Principais Sistemas</h4>
                            <ul>
                                <li><strong>STR (Sistema de Transfer√™ncia de Reservas):</strong> √â o cora√ß√£o do sistema. Onde os bancos transferem dinheiro entre si (nas contas que eles t√™m no Bacen). Liquida√ß√£o em Tempo Real (LBTR).</li>
                                <li><strong>SPI (Sistema de Pagamentos Instant√¢neos):</strong> A infraestrutura do <strong>PIX</strong>. Funciona 24/7.</li>
                                <li><strong>CIP (C√¢mara Interbanc√°ria de Pagamentos):</strong> Processa boletos, cart√µes e TEDs antigos.</li>
                            </ul>
                            <div class="concept-box">
                                <strong>Risco de Liquida√ß√£o:</strong> O risco de um banco quebrar no meio do dia e n√£o pagar os outros. O SPB (via LBTR) elimina isso, pois a transfer√™ncia √© irrevog√°vel e instant√¢nea.
                            </div>
                        `,
                        practicalCase: "Quando voc√™ faz um PIX √†s 3 da manh√£ de domingo, o sistema SPI verifica se o seu banco tem fundos e transfere instantaneamente para o banco do recebedor. Sem o SPB, voc√™ dependeria da compensa√ß√£o manual no dia √∫til seguinte.",
                        details: [
                            { label: "Objetivo", value: "Reduzir o risco sist√™mico e dar agilidade." }
                        ]
                    },
                    {
                        title: "C√≥digos ANBIMA (Regula√ß√£o vs Autorregula√ß√£o)",
                        keywords: ["MELHORES PR√ÅTICAS", "SELO ANBIMA"],
                        description: "Regras que o mercado cria para si mesmo (al√©m da lei).",
                        content: `
                            <h4>üìú Principais C√≥digos</h4>
                            <ul>
                                <li><strong>C√≥digo de Administra√ß√£o de Recursos:</strong> Regras para Gestores de Fundos (Chinese Wall, marca√ß√£o a mercado, rateio de ordens).</li>
                                <li><strong>C√≥digo de Distribui√ß√£o:</strong> Regras para quem vende produtos (Gerentes, Corretores). Exige Suitability, transpar√™ncia e selo Anbima.</li>
                            </ul>
                            <h4>‚öñÔ∏è Regula√ß√£o vs Autorregula√ß√£o</h4>
                            <ul>
                                <li><strong>Regula√ß√£o (Estado):</strong> Leis do CMN/Bacen/CVM. Quem descumpre sofre multa ou pris√£o.</li>
                                <li><strong>Autorregula√ß√£o (Anbima):</strong> Regras privadas. Quem descumpre perde o Selo Anbima ou √© expulso da associa√ß√£o (mas n√£o vai preso).</li>
                            </ul>
                        `,
                        practicalCase: "Um fundo de investimento quer ter o 'Selo Anbima' na l√¢mina. Para isso, ele deve seguir regras de transpar√™ncia mais r√≠gidas do que a CVM exige. Isso gera confian√ßa no investidor.",
                        details: [
                            { label: "Follow the Money", value: "A Anbima foca na conduta √©tica e transpar√™ncia." }
                        ]
                    },
                    {
                        title: "Prazos de Liquida√ß√£o (A Sopa de Letrinhas)",
                        keywords: ["D+0", "D+1", "D+2"],
                        description: "Quando o dinheiro cai na conta ou sai dela.",
                        content: `
                            <table class="custom-table">
                                <tr><th>Produto</th><th>Prazo Padr√£o</th></tr>
                                <tr><td>A√ß√µes (B3)</td><td>D+2 (Dois dias √∫teis ap√≥s a negocia√ß√£o)</td></tr>
                                <tr><td>Tesouro Direto</td><td>D+1 (Dia seguinte)</td></tr>
                                <tr><td>Fundos (Cotiza√ß√£o)</td><td>Varia (D+0, D+1, D+30...). Ler o regulamento.</td></tr>
                                <tr><td>Fundos (Liquida√ß√£o)</td><td>Dia que o dinheiro cai (ex: D+1 ap√≥s cotiza√ß√£o).</td></tr>
                            </table>
                            <div class="alert-box">
                                <strong>Cuidado:</strong> Cotiza√ß√£o (transformar dinheiro em cota) √© diferente de Liquida√ß√£o (dinheiro na m√£o).
                            </div>
                        `
                    }
                ]
            },
            mod1: {
                id: "mod1",
                title: "M1: SFN & Economia",
                icon: "landmark",
                color: "bg-blue-600",
                textClass: "text-blue-600",
                borderClass: "border-blue-600",
                topics: [
                    {
                        title: "CMN vs BACEN (A Grande Diferen√ßa)",
                        keywords: ["QUEM MANDA", "QUEM FAZ", "HIERARQUIA"],
                        description: "Distin√ß√£o crucial para a prova. Um pensa, o outro age.",
                        content: `
                            <h4>üèõÔ∏è CMN (Conselho Monet√°rio Nacional)</h4>
                            <p>√â o <strong>CHEFE</strong> (√ìrg√£o Normativo).</p>
                            <ul>
                                <li><strong>Verbos na prova:</strong> Autorizar, Regular, Fixar diretrizes, Disciplinar, Definir meta.</li>
                                <li><strong>Composi√ß√£o:</strong> Ministro da Fazenda (Presidente), Ministro do Planejamento, Presidente do Bacen.</li>
                            </ul>
                            <h4>üè¶ BACEN (Banco Central)</h4>
                            <p>√â o <strong>EXECUTOR</strong> (√ìrg√£o Supervisor).</p>
                            <ul>
                                <li><strong>Verbos na prova:</strong> Fiscalizar, Executar, Emitir papel-moeda, Receber compuls√≥rio, Realizar opera√ß√µes, Punir institui√ß√µes.</li>
                            </ul>
                            <div class="concept-box">
                                <strong>Dica de Ouro:</strong> O CMN n√£o p√µe a m√£o na massa. Ele n√£o fiscaliza ningu√©m, ele dita as regras. Quem suja as m√£os fiscalizando √© o Bacen (bancos) ou a CVM (bolsa).
                            </div>
                        `,
                        practicalCase: "O CMN decide que a meta de infla√ß√£o √© 3%. O Bacen, para cumprir essa ordem, aumenta a Selic. O CMN n√£o aumenta a Selic, ele s√≥ manda controlar a infla√ß√£o.",
                        details: [
                            { label: "Quem emite moeda?", value: "BACEN (autorizado pelo CMN)." },
                            { label: "Quem fiscaliza banco?", value: "BACEN." }
                        ]
                    },
                    {
                        title: "CVM (Comiss√£o de Valores Mobili√°rios)",
                        keywords: ["BOLSA", "FUNDOS", "S.A. ABERTA"],
                        description: "A 'pol√≠cia' do mercado de capitais (Bolsa, Fundos).",
                        content: `
                            <h4>üéØ Fun√ß√£o</h4>
                            <p>Fiscalizar, normatizar, disciplinar e desenvolver o mercado de valores mobili√°rios (a√ß√µes, deb√™ntures, fundos, derivativos).</p>
                            <h4>üö´ O que N√ÉO √© com a CVM</h4>
                            <ul>
                                <li>Conta Corrente, Cheque, Poupan√ßa, CDB (Isso √© Bacen).</li>
                                <li>Seguros e Previd√™ncia (Isso √© Susep/Previc).</li>
                            </ul>
                            <h4>üõ°Ô∏è Objetivo</h4>
                            <p>Proteger o investidor contra emiss√µes irregulares e atos ilegais, garantindo o acesso √† informa√ß√£o.</p>
                        `,
                        practicalCase: "Se a Petrobras divulga um balan√ßo falso, a CVM investiga e pune. Se um Fundo de Investimento engana cotistas, a CVM atua.",
                        details: [
                            { label: "Vincula√ß√£o", value: "Autarquia vinculada ao Minist√©rio da Fazenda, mas independente." }
                        ]
                    },
                    {
                        title: "Seguros e Previd√™ncia (CNSP, SUSEP, CNPC, PREVIC)",
                        keywords: ["SEGUROS", "PREVID√äNCIA", "NORMATIVO", "EXECUTIVO"],
                        description: "A sopa de letrinhas dos seguros e pens√µes.",
                        content: `
                            <h4>üöó Seguros, Capitaliza√ß√£o e Previd√™ncia Aberta (PGBL/VGBL)</h4>
                            <ul>
                                <li><strong>CNSP (Conselho Nacional de Seguros Privados):</strong> √ìrg√£o Normativo (Manda). Define as regras gerais.</li>
                                <li><strong>SUSEP (Superintend√™ncia de Seguros Privados):</strong> √ìrg√£o Executor/Fiscalizador. Fiscaliza as seguradoras e entidades de previd√™ncia aberta.</li>
                            </ul>
                            <h4>üè≠ Previd√™ncia Fechada (Fundos de Pens√£o)</h4>
                            <ul>
                                <li><strong>CNPC (Conselho Nacional de Previd√™ncia Complementar):</strong> √ìrg√£o Normativo. Cria as regras para fundos de pens√£o (ex: Previ, Petros).</li>
                                <li><strong>PREVIC (Superintend√™ncia Nacional de Previd√™ncia Complementar):</strong> √ìrg√£o Fiscalizador. Vigia os fundos de pens√£o.</li>
                            </ul>
                        `,
                        practicalCase: "Se voc√™ contrata um seguro de carro na Porto Seguro, quem fiscaliza se ela tem dinheiro para pagar a indeniza√ß√£o √© a SUSEP. Se voc√™ trabalha no Banco do Brasil e contribui para a PREVI, quem fiscaliza √© a PREVIC.",
                        details: [
                            { label: "Dica", value: "Come√ßa com C = Conselho (Manda). Come√ßa com S ou P = Superintend√™ncia (Fiscaliza)." }
                        ]
                    },
                    {
                        title: "Pol√≠tica Monet√°ria (O Motor dos Juros)",
                        keywords: ["SELIC", "COMPULS√ìRIO", "OPEN MARKET", "INFLA√á√ÉO"],
                        description: "Conjunto de a√ß√µes do Banco Central para controlar a quantidade de dinheiro e juros na economia.",
                        content: `
                            <div class="concept-box">
                                üéØ <strong>Objetivo Principal:</strong> Controlar a infla√ß√£o e garantir a estabilidade da moeda.
                            </div>
                            <h4>üõ†Ô∏è Principais Instrumentos (Cai MUITO na prova)</h4>
                            <ol class="list-decimal pl-5 space-y-2">
                                <li><strong>Taxa Selic (Meta):</strong> Definida pelo COPOM a cada 45 dias.
                                    <br><em>Aumenta Selic ‚Üí Cr√©dito caro ‚Üí Consumo cai ‚Üí Infla√ß√£o cai (Pol√≠tica Contracionista).</em></li>
                                <li><strong>Open Market (Mercado Aberto):</strong> Compra e venda de t√≠tulos p√∫blicos pelo Bacen.
                                    <br><em>Bacen Vende T√≠tulos ‚Üí Tira dinheiro do mercado (Enxuga liquidez).</em>
                                    <br><em>Bacen Compra T√≠tulos ‚Üí D√° dinheiro ao mercado (Injeta liquidez).</em></li>
                                <li><strong>Dep√≥sito Compuls√≥rio:</strong> Dinheiro que os bancos s√£o obrigados a deixar guardado no Bacen.
                                    <br><em>Aumenta Compuls√≥rio ‚Üí Menos dinheiro para emprestar (Contracionista).</em></li>
                                <li><strong>Redesconto:</strong> Empr√©stimo do Bacen para bancos com problemas de liquidez (juro punitivo).</li>
                            </ol>
                        `,
                        practicalCase: "A infla√ß√£o oficial (IPCA) bateu 10% no ano (muito acima da meta). O que o Bacen faz? Na reuni√£o do COPOM, ele decide AUMENTAR a meta da Taxa Selic para esfriar o consumo.",
                        details: [
                            { label: "Instrumento Mais √Ågil", value: "Open Market (acontece todo dia)." }
                        ]
                    },
                    {
                        title: "Pol√≠tica Fiscal (O Bolso do Governo)",
                        keywords: ["IMPOSTOS", "GASTOS P√öBLICOS", "SUPER√ÅVIT PRIM√ÅRIO"],
                        description: "Administra√ß√£o das receitas (impostos) e despesas (gastos) do Governo Federal.",
                        content: `
                            <h4>üéØ Conceito</h4>
                            <p>√â como o governo gerencia seu or√ßamento para influenciar a economia.</p>
                            <h4>üìä Resultados Fiscais</h4>
                            <ul>
                                <li><strong>Super√°vit Prim√°rio:</strong> Governo arrecadou mais do que gastou (antes de pagar juros da d√≠vida). √â a economia para pagar os juros.</li>
                                <li><strong>D√©ficit Prim√°rio:</strong> Governo gastou mais do que arrecadou. Gera aumento da d√≠vida p√∫blica.</li>
                                <li><strong>D√©ficit Nominal:</strong> Resultado prim√°rio + pagamento de juros da d√≠vida.</li>
                            </ul>
                            <div class="concept-box">
                                üü¢ <strong>Pol√≠tica Fiscal Expansionista:</strong> Governo gasta mais ou reduz impostos (estimula PIB, mas pode gerar infla√ß√£o).<br>
                                üî¥ <strong>Pol√≠tica Fiscal Contracionista:</strong> Governo corta gastos ou aumenta impostos (freia economia e infla√ß√£o).
                            </div>
                        `,
                        practicalCase: "O governo quer estimular a venda de carros. Ele reduz o IPI (Imposto sobre Produtos Industrializados). Isso √© uma medida de Pol√≠tica Fiscal Expansionista (ren√∫ncia fiscal para estimular consumo).",
                        details: [
                            { label: "Quem Executa", value: "Governo Federal (Tesouro Nacional / Minist√©rio da Fazenda)." }
                        ]
                    },
                    {
                        title: "Pol√≠tica Cambial (O Valor da Moeda)",
                        keywords: ["D√ìLAR", "SWAP CAMBIAL", "RESERVAS"],
                        description: "A√ß√µes para controlar a taxa de c√¢mbio (pre√ßo da moeda estrangeira).",
                        content: `
                            <h4>üíµ Regime Cambial Brasileiro</h4>
                            <p><strong>Flutua√ß√£o Suja (Dirty Float):</strong> O c√¢mbio flutua conforme oferta e demanda, mas o Bacen interv√©m (compra/venda) para evitar oscila√ß√µes muito bruscas (volatilidade excessiva).</p>
                            <h4>üõ†Ô∏è Atua√ß√£o do BACEN</h4>
                            <ul>
                                <li><strong>Leil√£o de Swap Cambial:</strong> O Bacen oferece prote√ß√£o contra a alta do d√≥lar (equivale a vender d√≥lares no futuro) para acalmar o mercado.</li>
                                <li><strong>Reservas Internacionais:</strong> O "colch√£o" de d√≥lares que o pa√≠s tem para emerg√™ncias.</li>
                            </ul>
                        `,
                        practicalCase: "O D√≥lar disparou para R$ 6,00 em um dia de p√¢nico. O Bacen entra vendendo Swap Cambial para acalmar o mercado.",
                        details: [
                            { label: "PTAX", value: "M√©dia das taxas de c√¢mbio praticadas no mercado, calculada pelo Bacen diariamente." }
                        ]
                    },
                    {
                        title: "Risco, Retorno e Liquidez (O Trip√©)",
                        keywords: ["TRADE-OFF", "VOLATILIDADE", "RESGATE"],
                        description: "Conceitos fundamentais para qualquer investimento.",
                        content: `
                            <h4>‚öñÔ∏è A Regra de Ouro (Trade-off)</h4>
                            <p>N√£o existe m√°gica. Geralmente, para ganhar mais (Retorno), voc√™ precisa correr mais perigo (Risco) ou abrir m√£o do dinheiro por um tempo (Liquidez).</p>
                            <ul>
                                <li><strong>Risco:</strong> √â a incerteza. A chance de o retorno ser diferente do esperado.
                                    <br><em>Ex: A√ß√µes t√™m risco alto (pode cair 50% ou subir 50%).</em></li>
                                <li><strong>Retorno:</strong> √â o ganho financeiro. O pr√™mio por correr risco.</li>
                                <li><strong>Liquidez:</strong> √â a velocidade de transformar o ativo em dinheiro pelo pre√ßo justo.
                                    <br><em>Ex: Poupan√ßa (Alta liquidez, saca na hora). Im√≥vel (Baixa liquidez, demora meses para vender).</em></li>
                            </ul>
                        `,
                        practicalCase: "Um cliente quer: Alta Rentabilidade, Risco Zero e Liquidez Imediata. Esse produto N√ÉO EXISTE. Se algu√©m oferecer, √© golpe.",
                        details: [
                            { label: "Rela√ß√£o", value: "Maior Risco exige Maior Retorno esperado." }
                        ]
                    },
                    {
                        title: "Acordo de Basileia (Solidez Banc√°ria)",
                        keywords: ["√çNDICE DE BASILEIA", "RISCO SIST√äMICO", "CAPITAL PR√ìPRIO"],
                        description: "Regras internacionais para garantir que bancos n√£o quebrem.",
                        content: `
                            <h4>üõ°Ô∏è O que √©?</h4>
                            <p>Um acordo global que define quanto dinheiro pr√≥prio o banco precisa ter para cada real que ele empresta. Evita a alavancagem excessiva.</p>
                            <div class="concept-box">
                                <strong>√çndice de Basileia:</strong> Se o √≠ndice √© 11%, significa que para emprestar R$ 100,00, o banco precisa ter R$ 11,00 de capital pr√≥prio. Ele s√≥ pode usar R$ 89,00 do dinheiro dos clientes (dep√≥sitos).
                            </div>
                        `,
                        practicalCase: "O Banco X quer emprestar bilh√µes. O Bacen barra e diz: 'Voc√™ n√£o tem Patrim√¥nio de Refer√™ncia suficiente segundo Basileia'. Isso protege o sistema de quebras em cadeia.",
                        details: [
                            { label: "Objetivo", value: "Evitar risco sist√™mico (efeito domin√≥)." }
                        ]
                    },
                    {
                        title: "Indicadores Econ√¥micos Detalhados",
                        keywords: ["PIB", "IPCA", "IGPM", "CDI"],
                        description: "Como medimos a sa√∫de da economia e o custo de vida.",
                        content: `
                            <h4>üìà PIB (Produto Interno Bruto)</h4>
                            <p>Soma de todos os bens e servi√ßos finais produzidos no pa√≠s.</p>
                            <ul>
                                <li><strong>F√≥rmula (√ìtica Despesa):</strong> PIB = C (Consumo) + I (Investimento) + G (Gastos Gov) + (X - M) (Exporta√ß√£o - Importa√ß√£o).</li>
                            </ul>
                            <h4>üõí IPCA (Infla√ß√£o Oficial)</h4>
                            <ul>
                                <li><strong>Calculado por:</strong> IBGE.</li>
                                <li><strong>P√∫blico:</strong> Fam√≠lias com renda de 1 a 40 sal√°rios m√≠nimos (varejo).</li>
                                <li><strong>Uso:</strong> Meta de infla√ß√£o do governo.</li>
                            </ul>
                            <h4>üè† IGP-M (Infla√ß√£o do Aluguel)</h4>
                            <ul>
                                <li><strong>Calculado por:</strong> FGV.</li>
                                <li><strong>Composi√ß√£o (Decorar!):</strong> 60% IPA (Atacado) + 30% IPC (Consumidor) + 10% INCC (Constru√ß√£o).</li>
                                <li><strong>Dica:</strong> Muito sens√≠vel ao D√≥lar (IPA 60%).</li>
                            </ul>
                        `,
                        practicalCase: "Seu aluguel vence em julho. O contrato diz 'reajuste pelo IGP-M'. Se o d√≥lar subiu muito no ano, o IGP-M explode (por causa do IPA 60%) e seu aluguel sobe muito mais que o seu sal√°rio (que segue o INPC/IPCA).",
                        details: [
                            { label: "TR", value: "Taxa Referencial. Usada na Poupan√ßa e FGTS." }
                        ]
                    }
                ]
            },
            mod2: {
                id: "mod2",
                title: "M2: Produtos",
                icon: "package",
                color: "bg-purple-600",
                textClass: "text-purple-600",
                borderClass: "border-purple-600",
                topics: [
                    {
                        title: "Renda Fixa - T√≠tulos P√∫blicos (Tesouro Direto)",
                        keywords: ["TESOURO SELIC", "PREFIXADO", "IPCA+", "RISCO SOBERANO"],
                        description: "Empr√©stimo ao Governo Federal. O investimento mais seguro do pa√≠s (Risco Soberano).",
                        content: `
                            <h4>üîπ Tesouro Selic (LFT)</h4>
                            <p><strong>P√≥s-fixado:</strong> Acompanha a taxa Selic. O valor do t√≠tulo sobe todo dia (n√£o tem rentabilidade negativa se levar at√© o fim).<br>üëâ <em>Ideal para:</em> Reserva de Emerg√™ncia e curto prazo.</p>
                            <h4>üîπ Tesouro Prefixado (LTN)</h4>
                            <p><strong>Taxa Fixa:</strong> Voc√™ sabe exatamente quanto vai receber (ex: 12% a.a.) se ficar at√© o fim.<br>‚ö†Ô∏è <em>Risco:</em> Marca√ß√£o a Mercado. Se vender antes e os juros subirem, voc√™ perde dinheiro.</p>
                            <h4>üîπ Tesouro IPCA+ (NTN-B)</h4>
                            <p><strong>H√≠brido:</strong> Paga a infla√ß√£o (IPCA) + uma taxa fixa (ex: IPCA + 5%).<br>üëâ <em>Ideal para:</em> Longo prazo, aposentadoria (protege o poder de compra).</p>
                        `,
                        practicalCase: "Voc√™ comprou um Tesouro Prefixado a 10% a.a. Hoje a taxa subiu para 14% a.a. Se voc√™ vender seu t√≠tulo hoje, ele vale MENOS, porque o mercado prefere o t√≠tulo novo de 14%. Se segurar at√© o vencimento, recebe os 10% contratados.",
                        details: [
                            { label: "Liquidez", value: "D+1 (Pede hoje, cai amanh√£)." },
                            { label: "IR", value: "Tabela Regressiva." }
                        ]
                    },
                    {
                        title: "Renda Fixa - T√≠tulos Privados",
                        keywords: ["CDB", "LCI", "LCA", "DEB√äNTURES", "FGC"],
                        description: "Empr√©stimos para Bancos (CDB/LCI/LCA) ou Empresas (Deb√™ntures).",
                        content: `
                            <h4>üè¶ Banc√°rios (Com FGC)</h4>
                            <ul>
                                <li><strong>CDB (Certificado de Dep√≥sito Banc√°rio):</strong> Empr√©stimo ao banco. Tributado (Regressiva).</li>
                                <li><strong>LCI/LCA (Letras de Cr√©dito):</strong> Empr√©stimo ao banco para financiar Im√≥veis ou Agro. <strong>ISENTO DE IR para PF.</strong></li>
                            </ul>
                            <h4>üè≠ Cr√©dito Privado (Sem FGC - Risco da Empresa)</h4>
                            <ul>
                                <li><strong>Deb√™ntures:</strong> T√≠tulos de d√≠vida de empresas S.A. (n√£o financeiras). Risco de cr√©dito maior.</li>
                                <li><strong>Deb√™nture Incentivada:</strong> Financia infraestrutura (estradas, energia). <strong>ISENTA DE IR para PF.</strong></li>
                                <li><strong>CRI/CRA:</strong> Certificados de Receb√≠veis (Imobili√°rio/Agro). Isentos para PF. Emitidos por Securitizadoras.</li>
                            </ul>
                        `,
                        practicalCase: "A Vale precisa construir uma ferrovia. Ela emite uma Deb√™nture Incentivada de Infraestrutura. Voc√™ empresta dinheiro pra Vale, recebe juros + IPCA e n√£o paga imposto de renda.",
                        details: [
                            { label: "FGC", value: "Garante at√© R$ 250 mil por CPF/Institui√ß√£o em caso de quebra do banco." }
                        ]
                    },
                    {
                        title: "Fundos de Investimento: Tipos e Estrutura",
                        keywords: ["ABERTO/FECHADO", "COTAS", "CNPJ PR√ìPRIO"],
                        description: "O 'Condom√≠nio' de investidores. Recursos em comum, regras iguais.",
                        content: `
                            <h4>üè¢ Estrutura</h4>
                            <ul>
                                <li><strong>Administrador:</strong> O 'dono legal', cuida da papelada e do cotista.</li>
                                <li><strong>Gestor:</strong> O 'c√©rebro', decide o que comprar e vender.</li>
                                <li><strong>Custodiante:</strong> O 'cofre', guarda os ativos.</li>
                            </ul>
                            <h4>üö™ Tipos de Condom√≠nio</h4>
                            <ul>
                                <li><strong>Fundo Aberto:</strong> Permite aplica√ß√µes e resgates a qualquer momento (maioria dos fundos).</li>
                                <li><strong>Fundo Fechado:</strong> Cotas s√≥ s√£o resgatadas no fim do prazo. Para sair antes, voc√™ tem que vender sua cota para outra pessoa (mercado secund√°rio). Ex: Fundos Imobili√°rios (FIIs).</li>
                            </ul>
                        `,
                        practicalCase: "Num fundo fechado, se muitos cotistas quiserem sair ao mesmo tempo, eles n√£o podem pedir resgate ao fundo. Eles precisam vender as cotas na bolsa, o que pode fazer o pre√ßo da cota cair (des√°gio).",
                        details: [
                            { label: "Segrega√ß√£o", value: "O patrim√¥nio do fundo n√£o se mistura com o do banco administrador (Chinese Wall)." }
                        ]
                    },
                    {
                        title: "Classifica√ß√£o de Fundos (CVM 175)",
                        keywords: ["RENDA FIXA", "A√á√ïES", "CAMBIAL", "MULTIMERCADO"],
                        description: "As 4 classes principais de fundos segundo a CVM.",
                        content: `
                            <ul>
                                <li><strong>Renda Fixa:</strong> M√≠nimo 80% em ativos de renda fixa. Foco em juros/√≠ndices de pre√ßo.
                                    <br><em>Tributa√ß√£o:</em> Regressiva + Come-cotas.</li>
                                <li><strong>A√ß√µes (FIA):</strong> M√≠nimo 67% em a√ß√µes. Risco alto.
                                    <br><em>Tributa√ß√£o:</em> 15% fixo no resgate (SEM Come-cotas).</li>
                                <li><strong>Cambial:</strong> M√≠nimo 80% em ativos atrelados a moeda (D√≥lar/Euro). Hedge.
                                    <br><em>Tributa√ß√£o:</em> Regressiva + Come-cotas.</li>
                                <li><strong>Multimercado:</strong> "Vale tudo". Pode investir em RF, A√ß√µes, C√¢mbio e Derivativos.
                                    <br><em>Tributa√ß√£o:</em> Regressiva + Come-cotas.</li>
                            </ul>
                        `,
                        practicalCase: "Seu gerente oferece um 'Fundo Multimercado'. O gestor pode estar comprado em D√≥lar, vendido em Bolsa e aplicado em Juros tudo ao mesmo tempo. √â fundamental ver a l√¢mina para entender o risco.",
                        details: [
                            { label: "Come-cotas", value: "Antecipa√ß√£o de IR (Maio e Novembro). Reduz o n¬∫ de cotas." }
                        ]
                    },
                    {
                        title: "Renda Vari√°vel e Derivativos",
                        keywords: ["A√á√ïES", "BDR", "ETF", "OP√á√ïES", "FUTUROS"],
                        description: "Investimentos de risco e contratos futuros.",
                        content: `
                            <h4>üìâ A√ß√µes</h4>
                            <ul>
                                <li><strong>ON (Ordin√°ria):</strong> Direito a VOTO. (S√≥cio dono).</li>
                                <li><strong>PN (Preferencial):</strong> Prefer√™ncia em DIVIDENDOS. (S√≥cio investidor).</li>
                            </ul>
                            <h4>üåç BDRs e ETFs</h4>
                            <ul>
                                <li><strong>BDR:</strong> Recibo de a√ß√£o gringa (Apple) negociado aqui.</li>
                                <li><strong>ETF:</strong> Fundo que copia um √≠ndice (Ibovespa) e √© negociado como a√ß√£o.</li>
                            </ul>
                            <h4>‚ö° Derivativos (Para que servem?)</h4>
                            <ul>
                                <li><strong>Hedge (Prote√ß√£o):</strong> Agricultor fixa o pre√ßo do caf√© hoje para vender no futuro, evitando preju√≠zo se o pre√ßo cair.</li>
                                <li><strong>Especula√ß√£o:</strong> Apostar na dire√ß√£o do pre√ßo para lucrar.</li>
                                <li><strong>Alavancagem:</strong> Movimentar muito financeiro com pouco dinheiro em garantia.</li>
                            </ul>
                        `,
                        practicalCase: "No Mercado de Op√ß√µes, voc√™ pode comprar o 'direito' de comprar Petrobras a R$ 30,00 daqui a um m√™s. Se a a√ß√£o for a R$ 40,00, voc√™ exerce o direito e lucra a diferen√ßa.",
                        details: [
                            { label: "Swap", value: "Troca de indexadores (ex: Trocar d√≠vida em D√≥lar por d√≠vida em CDI)." }
                        ]
                    },
                    {
                        title: "Previd√™ncia Privada (Aposentadoria)",
                        keywords: ["PGBL", "VGBL", "TABELA REGRESSIVA"],
                        description: "Produtos focados no longo prazo e sucess√£o patrimonial.",
                        content: `
                            <h4>üÜö PGBL x VGBL (A D√∫vida Cl√°ssica)</h4>
                            <ul>
                                <li><strong>PGBL (Plano Gerador de Benef√≠cio Livre):</strong>
                                    <br>‚úÖ <strong>Vantagem:</strong> Abate at√© 12% da renda bruta na declara√ß√£o completa do IR.
                                    <br>‚ùå <strong>Desvantagem:</strong> No resgate, o IR incide sobre o valor TOTAL (Capital + Juros).
                                    <br>üëâ <em>Indicado para quem faz declara√ß√£o completa.</em></li>
                                <li><strong>VGBL (Vida Gerador de Benef√≠cio Livre):</strong>
                                    <br>‚úÖ <strong>Vantagem:</strong> No resgate, IR incide S√ì sobre o rendimento (lucro).
                                    <br>‚ùå <strong>Desvantagem:</strong> N√£o tem benef√≠cio fiscal na entrada.
                                    <br>üëâ <em>Indicado para isentos ou declara√ß√£o simplificada.</em></li>
                            </ul>
                        `,
                        practicalCase: "Dr. Andr√© √© m√©dico, renda alta, declara√ß√£o completa. Ele investe em PGBL at√© dar 12% da renda bruta para pagar menos imposto agora. O resto do dinheiro ele p√µe em VGBL ou outros ativos.",
                        details: [
                            { label: "Sucess√£o", value: "VGBL n√£o entra em invent√°rio (vai direto para benefici√°rios)." }
                        ]
                    },
                    {
                        title: "Finan√ßas Descentralizadas (DeFi) e Cripto",
                        keywords: ["BITCOIN", "SMART CONTRACTS", "TOKENIZA√á√ÉO"],
                        description: "O futuro do mercado sem intermedi√°rios.",
                        content: `
                            <h4>ü™ô Criptoativos</h4>
                            <p>Ativos digitais em blockchain. Bitcoin (reserva de valor), Ethereum (plataforma).</p>
                            <h4>üè¶ DeFi (Decentralized Finance)</h4>
                            <p>Servi√ßos financeiros (empr√©stimo, troca, seguros) que rodam em c√≥digo (Smart Contracts) sem banco central ou institui√ß√£o no meio.</p>
                            <h4>üìú Smart Contracts</h4>
                            <p>Contratos autoexecut√°veis. "Se o cliente depositar X, libere Y". N√£o precisa de advogado, o c√≥digo garante a execu√ß√£o.</p>
                        `,
                        practicalCase: "Em uma plataforma DeFi, voc√™ pode emprestar suas criptomoedas para um 'pool' e receber juros pagos por quem toma emprestado, tudo gerido por um algoritmo.",
                        details: [
                            { label: "Tokeniza√ß√£o", value: "Dividir um ativo real (im√≥vel) em peda√ßos digitais (tokens)." }
                        ]
                    }
                ]
            },
            mod3: {
                id: "mod3",
                title: "M3: Clientes",
                icon: "users",
                color: "bg-orange-600",
                textClass: "text-orange-600",
                borderClass: "border-orange-600",
                topics: [
                    {
                        title: "Suitability (API) e KYC",
                        keywords: ["PERFIL DE RISCO", "LAVAGEM DE DINHEIRO", "CADASTRO"],
                        description: "Conhecer o cliente para proteger o cliente e o banco.",
                        content: `
                            <h4>üßê Suitability (Adequa√ß√£o)</h4>
                            <p>Obriga√ß√£o de verificar se o produto combina com o perfil do cliente (API).</p>
                            <ul>
                                <li><strong>Conservador:</strong> Seguran√ßa > Rentabilidade.</li>
                                <li><strong>Moderado:</strong> Equil√≠brio.</li>
                                <li><strong>Arrojado:</strong> Foco em rentabilidade, aguenta perdas.</li>
                            </ul>
                            <div class="concept-box">
                                Se o cliente quer investir fora do perfil, ele DEVE assinar uma declara√ß√£o expressa de desenquadramento. O banco n√£o pode recomendar, mas pode acatar a ordem.
                            </div>
                            <h4>üïµÔ∏è KYC (Know Your Customer)</h4>
                            <p>"Conhe√ßa seu Cliente". Verificar a origem do patrim√¥nio, capacidade financeira e atividade para evitar lavagem de dinheiro.</p>
                        `,
                        practicalCase: "Dona Maria, 80 anos, perfil Conservador. O gerente N√ÉO pode recomendar um Fundo de A√ß√µes Alavancado, mesmo que esteja rendendo muito. Viola o Suitability.",
                        details: [
                            { label: "Validade API", value: "Deve ser renovado a cada 24 meses." }
                        ]
                    },
                    {
                        title: "PLD/FT (Lavagem de Dinheiro)",
                        keywords: ["COI", "INTEGRA√á√ÉO", "COAF", "PENAS"],
                        description: "Preven√ß√£o √† Lavagem de Dinheiro e Financiamento ao Terrorismo.",
                        content: `
                            <h4>üîÑ As 3 Fases da Lavagem (Cai na Ordem!)</h4>
                            <ol class="list-decimal pl-5 space-y-2">
                                <li><strong>Coloca√ß√£o (Placement):</strong> O dinheiro sujo entra no sistema (ex: dep√≥sitos fracionados). Fase mais cr√≠tica.</li>
                                <li><strong>Oculta√ß√£o (Layering):</strong> Movimenta√ß√µes complexas para despistar o rastro.</li>
                                <li><strong>Integra√ß√£o (Integration):</strong> O dinheiro volta para a economia com "cara" de limpo (ex: compra de im√≥veis).</li>
                            </ol>
                            <div class="alert-box">
                                <strong>Puni√ß√£o:</strong> Reclus√£o de 3 a 10 anos + Multa. A tentativa tamb√©m √© punida!
                            </div>
                        `,
                        practicalCase: "O gerente percebe dep√≥sitos fracionados de R$ 9.000 (logo abaixo do limite de notifica√ß√£o autom√°tica). Ele deve comunicar ao COAF como opera√ß√£o suspeita, SEM avisar o cliente.",
                        details: [
                            { label: "COAF", value: "Unidade de Intelig√™ncia Financeira. Recebe as den√∫ncias." }
                        ]
                    },
                    {
                        title: "√âtica e Conduta",
                        keywords: ["FRONT RUNNING", "CHURNING", "SIGILO"],
                        description: "Pr√°ticas proibidas e deveres fiduci√°rios.",
                        content: `
                            <h4>üö´ Pr√°ticas Ilegais</h4>
                            <ul>
                                <li><strong>Front Running:</strong> Corretor compra uma a√ß√£o para si mesmo ANTES de executar uma ordem grande de cliente. (Crime).</li>
                                <li><strong>Churning:</strong> Girar a carteira do cliente excessivamente s√≥ para gerar corretagem para o profissional.</li>
                                <li><strong>Venda Casada:</strong> "S√≥ libero seu empr√©stimo se levar esse seguro". (Proibido).</li>
                            </ul>
                        `,
                        practicalCase: "O cliente pede para comprar 1 milh√£o de a√ß√µes da Petrobras. O corretor sabe que isso vai subir o pre√ßo. Ele compra para si mesmo antes e depois executa a ordem do cliente. Isso √© Front Running.",
                        details: [
                            { label: "Princ√≠pio", value: "O interesse do cliente est√° acima do interesse da institui√ß√£o." }
                        ]
                    }
                ]
            },
            mod4: {
                id: "mod4",
                title: "M4: Inova√ß√£o",
                icon: "rocket",
                color: "bg-teal-600",
                textClass: "text-teal-600",
                borderClass: "border-teal-600",
                topics: [
                    {
                        title: "ESG (Sustentabilidade)",
                        keywords: ["ASG", "GREENWASHING", "CVM 175"],
                        description: "Environmental, Social and Governance. O dinheiro seguindo prop√≥sitos.",
                        content: `
                            <h4>üå± Os 3 Pilares</h4>
                            <ul>
                                <li><strong>E (Ambiental):</strong> Mudan√ßas clim√°ticas, efici√™ncia energ√©tica, gest√£o de res√≠duos.</li>
                                <li><strong>S (Social):</strong> Direitos humanos, rela√ß√µes de trabalho, diversidade.</li>
                                <li><strong>G (Governan√ßa):</strong> Transpar√™ncia, √©tica, independ√™ncia do conselho.</li>
                            </ul>
                            <h4>üé≠ Greenwashing</h4>
                            <p>Fingir que √© sustent√°vel (marketing enganoso). A <strong>Resolu√ß√£o CVM 175</strong> exige regras claras para fundos 'ESG' para combater isso.</p>
                        `,
                        practicalCase: "Um fundo se diz 'Verde' mas investe em carvoarias ilegais. Isso √© Greenwashing e gera risco de imagem e legal.",
                        details: [
                            { label: "Tend√™ncia", value: "Investidores estrangeiros exigem ESG." }
                        ]
                    },
                    {
                        title: "Open Finance (Sistema Aberto)",
                        keywords: ["COMPARTILHAMENTO", "CONSENTIMENTO", "API"],
                        description: "O cliente √© dono dos seus dados banc√°rios.",
                        content: `
                            <h4>üîì O Conceito</h4>
                            <p>Com autoriza√ß√£o (Consentimento), voc√™ pode levar seu hist√≥rico banc√°rio para outro banco para conseguir taxas melhores.</p>
                            <h4>üîë Princ√≠pios</h4>
                            <ul>
                                <li><strong>Consentimento:</strong> O cliente precisa autorizar ativamente.</li>
                                <li><strong>Reciprocidade:</strong> Institui√ß√µes devem trocar dados de forma padronizada (APIs).</li>
                            </ul>
                        `,
                        practicalCase: "Voc√™ tem conta no Banco A h√° 10 anos. Vai pedir cr√©dito no Banco B. Pelo Open Finance, o Banco B v√™ seu hist√≥rico de bom pagador no Banco A e te d√° juros menores.",
                        details: [
                            { label: "Objetivo", value: "Aumentar a competi√ß√£o e baixar o custo do cr√©dito." }
                        ]
                    }
                ]
            }
        };

        // --- BANCO DE QUEST√ïES (100 Itens) ---
        // Mantido exatamente como estava, com as 100 quest√µes.
        const quizQuestions = [
            // ... (Todas as 100 quest√µes anteriores permanecem aqui - c√≥digo suprimido visualmente para brevidade, mas est√° no arquivo completo) ...
            { m: "M1", q: "O √≥rg√£o m√°ximo do Sistema Financeiro Nacional √©:", o: ["BACEN", "CVM", "ANBIMA", "CMN"], a: 3, e: "O Conselho Monet√°rio Nacional (CMN) √© o √≥rg√£o NORMATIVO m√°ximo. Ele manda, o Bacen executa." },
            { m: "M1", q: "A principal fun√ß√£o do Banco Central √©:", o: ["Criar leis financeiras", "Executar pol√≠ticas monet√°rias e fiscalizar", "Regular o mercado de capitais", "Representar investidores"], a: 1, e: "O Bacen executa as ordens do CMN e fiscaliza os bancos (guardi√£o da moeda)." },
            { m: "M1", q: "A CVM atua principalmente no:", o: ["Sistema banc√°rio", "Mercado de cr√©dito", "Mercado de capitais", "Mercado cambial"], a: 2, e: "CVM (Comiss√£o de Valores Mobili√°rios) regula Bolsa, Fundos e S.A." },
            { m: "M1", q: "A ANBIMA √© caracterizada como:", o: ["√ìrg√£o regulador estatal", "Autarquia federal", "Entidade de autorregula√ß√£o", "Banco p√∫blico"], a: 2, e: "ANBIMA √© uma entidade privada de autorregula√ß√£o (o mercado regulando a si mesmo)." },
            { m: "M1", q: "Qual institui√ß√£o pode captar dep√≥sitos √† vista?", o: ["Corretora", "Banco comercial", "Distribuidora", "CVM"], a: 1, e: "Apenas Bancos Comerciais (e M√∫ltiplos com carteira comercial) e Cooperativas podem ter conta corrente." },
            { m: "M1", q: "O c√°lculo do PIB pela √≥tica da despesa segue a f√≥rmula:", o: ["C + I + G + (X - M)", "C + I - G", "X - M", "C + I + G + T"], a: 0, e: "PIB = Consumo + Investimento + Gastos Gov + Exporta√ß√µes L√≠quidas (Exporta√ß√£o - Importa√ß√£o)." },
            { m: "M1", q: "A composi√ß√£o do IGP-M √©:", o: ["50% IPA, 50% IPC", "60% IPA, 30% IPC, 10% INCC", "40% IPA, 30% IPC, 30% INCC", "100% IPCA"], a: 1, e: "O IGP-M √© 60% Atacado (IPA), 30% Consumidor (IPC) e 10% Constru√ß√£o (INCC)." },
            { m: "M1", q: "Quem fiscaliza os Fundos de Pens√£o (Previd√™ncia Fechada)?", o: ["SUSEP", "PREVIC", "CVM", "CNSP"], a: 1, e: "Previd√™ncia Fechada = PREVIC. Previd√™ncia Aberta = SUSEP." },
            { m: "M1", q: "Taxa b√°sica de juros da economia brasileira:", o: ["CDI", "IPCA", "Selic", "TR"], a: 2, e: "A Meta Selic √© definida pelo COPOM (Bacen)." },
            { m: "M1", q: "O c√¢mbio representa:", o: ["Pre√ßo de ativos", "Troca de t√≠tulos", "Pre√ßo da moeda estrangeira em reais", "Taxa de juros"], a: 2, e: "C√¢mbio √© a rela√ß√£o de troca entre duas moedas." },
            { m: "M1", q: "Em um cen√°rio de alta infla√ß√£o, qual medida √© mais prov√°vel de ser adotada pelo BACEN?", o: ["Redu√ß√£o da Selic", "Aumento da Selic", "Redu√ß√£o do compuls√≥rio", "Expans√£o do cr√©dito"], a: 1, e: "Aumentar a Selic encarece o cr√©dito e desestimula o consumo, controlando a infla√ß√£o." },
            { m: "M1", q: "Quem define as diretrizes da pol√≠tica monet√°ria?", o: ["BACEN", "CVM", "Tesouro Nacional", "CMN"], a: 3, e: "O CMN define as diretrizes e metas; o BACEN executa." },
            { m: "M1", q: "A fun√ß√£o principal da CVM √© proteger:", o: ["Bancos", "O governo", "Investidores do mercado de capitais", "Institui√ß√µes financeiras"], a: 2, e: "A CVM fiscaliza o mercado de valores mobili√°rios (a√ß√µes, fundos, deb√™ntures)." },
            { m: "M1", q: "Um banco comercial atua principalmente em:", o: ["Mercado de capitais", "Mercado de seguros", "Intermedia√ß√£o financeira com dep√≥sitos √† vista", "Emiss√£o de a√ß√µes"], a: 2, e: "Bancos comerciais captam dep√≥sitos √† vista (conta corrente) e emprestam a curto/m√©dio prazo." },
            { m: "M1", q: "O SFN tem como objetivo principal:", o: ["Maximizar lucros banc√°rios", "Garantir cr√©dito apenas ao governo", "Promover desenvolvimento econ√¥mico com estabilidade", "Eliminar riscos financeiros"], a: 2, e: "O sistema busca intermediar recursos para desenvolver o pa√≠s de forma equilibrada." },
            { m: "M1", q: "Quando o real se desvaloriza frente ao d√≥lar, significa que:", o: ["O d√≥lar ficou mais barato", "O real ganhou poder de compra", "√â preciso mais reais para comprar d√≥lares", "A infla√ß√£o caiu automaticamente"], a: 2, e: "Desvaloriza√ß√£o cambial encarece a moeda estrangeira." },
            { m: "M1", q: "O mercado prim√°rio ocorre quando:", o: ["Um t√≠tulo √© revendido", "Um ativo √© negociado na bolsa", "H√° emiss√£o de novos t√≠tulos", "H√° especula√ß√£o de pre√ßos"], a: 2, e: "Mercado prim√°rio √© a primeira venda (o recurso vai para o emissor)." },
            { m: "M1", q: "O mercado secund√°rio √© importante porque:", o: ["Financia o governo", "Gera liquidez aos ativos", "Controla infla√ß√£o", "Cria moeda"], a: 1, e: "Permite que investidores vendam seus ativos para outros, gerando liquidez." },
            { m: "M1", q: "O compuls√≥rio banc√°rio serve para:", o: ["Aumentar o lucro dos bancos", "Controlar liquidez da economia", "Garantir rentabilidade", "Financiar empresas"], a: 1, e: "O BACEN recolhe parte dos dep√≥sitos para controlar a quantidade de dinheiro em circula√ß√£o." },
            { m: "M1", q: "A pol√≠tica fiscal √© conduzida principalmente pelo:", o: ["BACEN", "CMN", "Governo (Executivo)", "CVM"], a: 2, e: "Pol√≠tica fiscal refere-se a gastos e impostos do Governo." },
            { m: "M2", q: "O CDB √© um t√≠tulo:", o: ["P√∫blico", "De renda vari√°vel", "Banc√°rio de renda fixa", "Isento de IR"], a: 2, e: "CDB = Certificado de Dep√≥sito Banc√°rio. Voc√™ empresta ao banco." },
            { m: "M2", q: "Qual produto possui cobertura do FGC?", o: ["A√ß√µes", "Deb√™ntures", "CDB", "Fundos de a√ß√µes"], a: 2, e: "CDB, LCI, LCA e Poupan√ßa t√™m FGC. Deb√™ntures e Fundos N√ÉO." },
            { m: "M2", q: "LCI e LCA s√£o isentas de:", o: ["IOF", "IR para pessoa f√≠sica", "Taxa de administra√ß√£o", "Risco de cr√©dito"], a: 1, e: "Isen√ß√£o de IR para PF √© o grande atrativo das Letras de Cr√©dito." },
            { m: "M2", q: "O Tesouro Direto √© emitido por:", o: ["Bancos", "Empresas", "Governo Federal", "Corretoras"], a: 2, e: "S√£o t√≠tulos da d√≠vida p√∫blica federal (Risco Soberano)." },
            { m: "M2", q: "O risco predominante da renda vari√°vel √©:", o: ["Cr√©dito", "Mercado", "Liquidez", "Operacional"], a: 1, e: "Risco de Mercado = Oscila√ß√£o de pre√ßos (volatilidade)." },
            { m: "M2", q: "Fundos de investimento s√£o:", o: ["Aplica√ß√µes individuais", "Condom√≠nios de investidores", "Produtos banc√°rios", "T√≠tulos p√∫blicos"], a: 1, e: "Funcionam como um condom√≠nio: cada um tem uma cota (peda√ßo) do todo." },
            { m: "M2", q: "Taxa cobrada para gest√£o do fundo:", o: ["Performance", "Entrada", "Administra√ß√£o", "Cust√≥dia"], a: 2, e: "Taxa de Administra√ß√£o remunera o gestor e o administrador. Performance s√≥ se ganhar do benchmark." },
            { m: "M2", q: "A taxa de performance incide quando:", o: ["O fundo tem preju√≠zo", "O fundo supera um benchmark", "O cotista resgatar", "O mercado subir"], a: 1, e: "√â um pr√™mio por superar a meta (benchmark)." },
            { m: "M2", q: "Fundos de a√ß√µes devem manter no m√≠nimo:", o: ["51% em a√ß√µes", "67% em a√ß√µes", "80% em a√ß√µes", "100% em a√ß√µes"], a: 1, e: "Regra CVM: M√≠nimo de 67% (dois ter√ßos) em a√ß√µes." },
            { m: "M2", q: "ETF √©:", o: ["Fundo exclusivo", "Fundo que replica um √≠ndice", "A√ß√£o internacional", "T√≠tulo de renda fixa"], a: 1, e: "Exchange Traded Fund = Fundo de √çndice negociado em bolsa." },
            { m: "M2", q: "A principal caracter√≠stica da renda fixa √©:", o: ["Retorno imprevis√≠vel", "Rentabilidade conhecida ou previs√≠vel", "Isen√ß√£o de impostos", "Alta volatilidade"], a: 1, e: "As condi√ß√µes de remunera√ß√£o s√£o definidas no momento da aplica√ß√£o." },
            { m: "M2", q: "Deb√™ntures s√£o t√≠tulos emitidos por:", o: ["Governo", "Bancos", "Empresas", "Corretoras"], a: 2, e: "Empresas S.A. n√£o financeiras emitem deb√™ntures para financiar projetos." },
            { m: "M2", q: "O risco de cr√©dito est√° relacionado √†:", o: ["Oscila√ß√£o de pre√ßos", "Capacidade de pagamento do emissor", "Falta de liquidez", "Infla√ß√£o"], a: 1, e: "Risco de Calote (Default). A empresa/banco n√£o pagar o que deve." },
            { m: "M2", q: "O IR na renda fixa segue a tabela:", o: ["Progressiva", "Fixa", "Regressiva", "Isenta"], a: 2, e: "Quanto mais tempo fica, menos paga (22,5% at√© 15%)." },
            { m: "M2", q: "PGBL √© mais indicado para quem:", o: ["N√£o declara IR", "Usa declara√ß√£o completa", "Usa declara√ß√£o simplificada", "√â isento"], a: 1, e: "Permite abater at√© 12% da renda bruta anual tribut√°vel na declara√ß√£o completa." },
            { m: "M2", q: "No VGBL, o IR incide sobre:", o: ["Valor total", "Apenas rendimentos", "Apenas aportes", "Taxas"], a: 1, e: "No VGBL, o imposto √© s√≥ sobre o LUCRO. No PGBL, √© sobre TUDO." },
            { m: "M2", q: "A previd√™ncia complementar tem foco em:", o: ["Curto prazo", "Liquidez di√°ria", "Longo prazo", "Especula√ß√£o"], a: 2, e: "Objetivo principal √© aposentadoria (longu√≠ssimo prazo)." },
            { m: "M2", q: "Capitaliza√ß√£o tem como principal caracter√≠stica:", o: ["Investimento", "Prote√ß√£o previdenci√°ria", "Sorteios e forma√ß√£o de reserva", "Renda vari√°vel"], a: 2, e: "Capitaliza√ß√£o N√ÉO √© investimento. √â um jogo de sorteio onde voc√™ guarda dinheiro (geralmente rendendo pouco)." },
            { m: "M2", q: "Maior liquidez geralmente est√° associada a:", o: ["Renda vari√°vel", "Longo prazo", "Menor risco", "Curto prazo"], a: 3, e: "Produtos de curto prazo ou liquidez di√°ria permitem resgate r√°pido." },
            { m: "M2", q: "A diversifica√ß√£o tem como objetivo:", o: ["Eliminar riscos", "Aumentar impostos", "Reduzir riscos", "Garantir retorno"], a: 2, e: "N√£o elimina o risco sist√™mico, mas reduz o risco espec√≠fico da carteira." },
            { m: "M2", q: "Jo√£o investiu em um CDB de um banco m√©dio. O principal risco que ele corre √©:", o: ["Mercado", "Liquidez", "Cr√©dito", "Operacional"], a: 2, e: "Risco de o banco quebrar (calote). Coberto pelo FGC." },
            { m: "M2", q: "Um investimento com rentabilidade atrelada ao IPCA protege contra:", o: ["Risco cambial", "Risco de cr√©dito", "Infla√ß√£o", "Oscila√ß√£o da bolsa"], a: 2, e: "Garante a manuten√ß√£o do poder de compra." },
            { m: "M2", q: "Qual produto N√ÉO possui garantia do FGC?", o: ["CDB", "LCI", "LCA", "Deb√™nture"], a: 3, e: "Deb√™ntures s√£o t√≠tulos corporativos sem garantia do Fundo Garantidor." },
            { m: "M2", q: "Tesouro Selic √© mais indicado para:", o: ["Longu√≠ssimo prazo", "Especula√ß√£o", "Reserva de emerg√™ncia", "Alta rentabilidade"], a: 2, e: "Baixa volatilidade e liquidez di√°ria." },
            { m: "M2", q: "Um fundo que investe majoritariamente em t√≠tulos p√∫blicos √© classificado como:", o: ["Fundo multimercado", "Fundo cambial", "Fundo de renda fixa", "Fundo de a√ß√µes"], a: 2, e: "Fundo de Renda Fixa busca retorno em ativos de juros." },
            { m: "M2", q: "Em um fundo, o administrador √© respons√°vel por:", o: ["Decidir investimentos", "Gest√£o da carteira", "Parte operacional e regulat√≥ria", "Definir benchmark"], a: 2, e: "O Administrador cuida do funcionamento legal. O Gestor decide onde investir." },
            { m: "M2", q: "A taxa de performance s√≥ pode ser cobrada se:", o: ["O fundo tiver preju√≠zo", "Superar o benchmark", "O cotista resgatar", "O mercado subir"], a: 1, e: "√â um pr√™mio por superar a meta (benchmark)." },
            { m: "M2", q: "Um ETF √© negociado:", o: ["Diretamente com o gestor", "No Tesouro Direto", "Na bolsa de valores", "Apenas no vencimento"], a: 2, e: "Cotas de ETF s√£o compradas e vendidas na B3 como a√ß√µes." },
            { m: "M2", q: "Qual produto √© mais indicado para quem busca isen√ß√£o de IR e baixo risco?", o: ["A√ß√µes", "LCI/LCA", "Deb√™ntures", "Fundos multimercado"], a: 1, e: "LCI/LCA t√™m FGC e isen√ß√£o de IR para PF." },
            { m: "M2", q: "A principal vantagem da diversifica√ß√£o √©:", o: ["Garantir retorno", "Eliminar riscos", "Reduzir riscos", "Aumentar impostos"], a: 2, e: "Reduz o risco espec√≠fico da carteira (n√£o ponha todos ovos na mesma cesta)." },
            { m: "M2", q: "Deb√™ntures incentivadas possuem como benef√≠cio:", o: ["Garantia do FGC", "Isen√ß√£o de IR para PF", "Liquidez di√°ria", "Prote√ß√£o cambial"], a: 1, e: "Governo incentiva infraestrutura com isen√ß√£o fiscal." },
            { m: "M2", q: "Risco de liquidez ocorre quando:", o: ["O emissor n√£o paga", "O pre√ßo oscila", "N√£o √© poss√≠vel vender o ativo rapidamente", "A infla√ß√£o sobe"], a: 2, e: "Dificuldade em transformar o ativo em dinheiro pelo pre√ßo justo." },
            { m: "M2", q: "A tabela regressiva de IR favorece investimentos:", o: ["De curto prazo", "Isentos", "De longo prazo", "De renda vari√°vel"], a: 2, e: "A al√≠quota cai com o tempo (m√≠nima de 15% ap√≥s 2 anos)." },
            { m: "M2", q: "Um fundo fechado significa que:", o: ["N√£o h√° taxa", "N√£o permite resgates antes do prazo", "√â exclusivo", "N√£o tem risco"], a: 1, e: "Cotas s√≥ s√£o resgatadas no encerramento do fundo (pode vender no mercado secund√°rio)." },
            { m: "M2", q: "A cota de um fundo √© calculada com base:", o: ["No lucro do gestor", "No patrim√¥nio l√≠quido do fundo", "No n√∫mero de cotistas", "Na taxa Selic"], a: 1, e: "Patrim√¥nio L√≠quido dividido pelo n√∫mero de cotas." },
            { m: "M2", q: "PGBL permite:", o: ["Isen√ß√£o total de IR", "Dedu√ß√£o at√© 12% da renda bruta tribut√°vel", "IR apenas sobre rendimento", "Resgate sem imposto"], a: 1, e: "Benef√≠cio fiscal na declara√ß√£o completa." },
            { m: "M2", q: "VGBL √© mais indicado para quem:", o: ["Faz declara√ß√£o completa", "N√£o declara IR", "Usa declara√ß√£o simplificada", "Busca curto prazo"], a: 2, e: "Simplificada ou isentos." },
            { m: "M2", q: "Previd√™ncia √© indicada principalmente para:", o: ["Especula√ß√£o", "Reserva imediata", "Planejamento de longo prazo", "Alta liquidez"], a: 2, e: "Foco em aposentadoria." },
            { m: "M2", q: "T√≠tulo p√≥s-fixado significa:", o: ["Taxa definida no in√≠cio", "Rentabilidade atrelada a um indexador", "Sem risco", "Isento de imposto"], a: 1, e: "Segue um √≠ndice (Ex: 100% do CDI)." },
            { m: "M2", q: "Capitaliza√ß√£o N√ÉO tem como objetivo principal:", o: ["Sorteios", "Forma√ß√£o de reserva", "Investimento", "Disciplina financeira"], a: 2, e: "N√£o √© considerado investimento devido √† baixa rentabilidade e car√°ter de sorteio." },
            { m: "M3", q: "Suitability significa:", o: ["Venda agressiva", "Adequa√ß√£o ao perfil do cliente", "Rentabilidade m√°xima", "Livre escolha"], a: 1, e: "API (An√°lise de Perfil de Investidor). Vender o produto certo para a pessoa certa." },
            { m: "M3", q: "Um cliente conservador prioriza:", o: ["Alta rentabilidade", "Seguran√ßa e liquidez", "Risco elevado", "Renda vari√°vel"], a: 1, e: "Ele prefere ganhar pouco a correr risco de perder o principal." },
            { m: "M3", q: "A √©tica profissional exige:", o: ["Foco na comiss√£o", "Interesse da institui√ß√£o", "Interesse do cliente", "Sigilo parcial"], a: 2, e: "O interesse do cliente deve sempre prevalecer sobre o do gerente/banco." },
            { m: "M3", q: "KYC significa:", o: ["Know Your Client", "Keep Your Capital", "Know Your Company", "Keep Your Client"], a: 0, e: "Conhe√ßa seu Cliente. Essencial para evitar lavagem de dinheiro." },
            { m: "M3", q: "Opera√ß√µes suspeitas devem ser:", o: ["Incentivadas", "Ignoradas", "Comunicadas ao COAF", "Autorizadas"], a: 2, e: "Qualquer atipicidade deve ser reportada ao COAF, sem avisar o cliente." },
            { m: "M3", q: "Planejamento financeiro envolve:", o: ["Apenas investimentos", "Apenas cr√©dito", "Organiza√ß√£o das finan√ßas pessoais", "Apenas previd√™ncia"], a: 2, e: "√â uma vis√£o 360¬∫: or√ßamento, d√≠vidas, seguros, aposentadoria e investimentos." },
            { m: "M3", q: "Oferecer produto incompat√≠vel com o perfil:", o: ["√â permitido", "Viola normas de conduta", "√â recomendado", "N√£o gera impacto"], a: 1, e: "√â proibido, a menos que o cliente assine um termo expresso de desenquadramento." },
            { m: "M3", q: "A comunica√ß√£o com o cliente deve ser:", o: ["T√©cnica e complexa", "Clara e transparente", "R√°pida e superficial", "Apenas escrita"], a: 1, e: "O cliente deve entender exatamente o que est√° comprando e seus riscos." },
            { m: "M3", q: "A preven√ß√£o √† lavagem de dinheiro visa:", o: ["Aumentar lucros", "Controlar impostos", "Evitar uso do sistema para crimes", "Reduzir custos"], a: 2, e: "Evitar que dinheiro de origem il√≠cita (tr√°fico, corrup√ß√£o) entre na economia formal." },
            { m: "M3", q: "O relacionamento com o cliente deve ser baseado em:", o: ["Press√£o comercial", "Confian√ßa e transpar√™ncia", "Rentabilidade imediata", "Volume"], a: 1, e: "Relacionamento de longo prazo se constr√≥i com confian√ßa." },
            { m: "M3", q: "Suitability exige que o profissional:", o: ["Venda o produto mais rent√°vel", "Adeque produto ao perfil do cliente", "Priorize metas comerciais", "Ignore riscos"], a: 1, e: "Vender o produto adequado ao perfil de risco." },
            { m: "M3", q: "Um cliente conservador deve evitar:", o: ["CDB", "Tesouro Selic", "A√ß√µes", "LCI"], a: 2, e: "A√ß√µes t√™m alto risco de mercado." },
            { m: "M3", q: "KYC tem como objetivo:", o: ["Aumentar vendas", "Conhecer o cliente", "Reduzir custos", "Facilitar cr√©dito"], a: 1, e: "Know Your Client: prevenir lavagem de dinheiro." },
            { m: "M3", q: "Detectar opera√ß√µes at√≠picas faz parte da:", o: ["√âtica profissional", "Preven√ß√£o √† lavagem de dinheiro", "Pol√≠tica monet√°ria", "Autorregula√ß√£o"], a: 1, e: "Monitoramento de PLD/FT." },
            { m: "M3", q: "O interesse do cliente deve prevalecer sobre:", o: ["Normas", "Rentabilidade", "Comiss√£o do profissional", "Transpar√™ncia"], a: 2, e: "Conflito de interesses: cliente vem antes da comiss√£o." },
            { m: "M3", q: "Uma recomenda√ß√£o inadequada pode gerar:", o: ["Benef√≠cio ao cliente", "Penalidades ao profissional", "Maior rentabilidade", "Nenhuma consequ√™ncia"], a: 1, e: "Puni√ß√µes administrativas e perda de credibilidade." },
            { m: "M3", q: "Comunica√ß√£o eficiente √© aquela que √©:", o: ["T√©cnica", "Complexa", "Clara e adequada", "R√°pida"], a: 2, e: "O cliente precisa entender." },
            { m: "M3", q: "Planejamento financeiro inclui:", o: ["Apenas investimentos", "Apenas previd√™ncia", "Or√ßamento, objetivos e investimentos", "Cr√©dito banc√°rio"], a: 2, e: "Vis√£o global das finan√ßas." },
            { m: "M3", q: "√âtica no mercado financeiro exige:", o: ["Sigilo parcial", "Informa√ß√£o clara sobre riscos", "Venda agressiva", "Prioridade ao banco"], a: 1, e: "Transpar√™ncia total." },
            { m: "M3", q: "O perfil do cliente deve ser atualizado:", o: ["Nunca", "Apenas no primeiro atendimento", "Periodicamente", "Somente se houver preju√≠zo"], a: 2, e: "A vida e os objetivos mudam." },
            { m: "M4", q: "Open Finance permite:", o: ["Compartilhar dados sem consentimento", "Compartilhar dados com autoriza√ß√£o", "Uso exclusivo de bancos", "Apenas dados de investimentos"], a: 1, e: "A chave √© o CONSENTIMENTO do cliente." },
            { m: "M4", q: "Fintechs s√£o:", o: ["Bancos p√∫blicos", "Empresas tradicionais", "Empresas de tecnologia financeira", "√ìrg√£os reguladores"], a: 2, e: "Technology + Finance. Startups que inovam no setor." },
            { m: "M4", q: "ESG refere-se a crit√©rios:", o: ["Econ√¥micos", "Tecnol√≥gicos", "Ambientais, Sociais e Governan√ßa", "Financeiros"], a: 2, e: "Environmental, Social, Governance." },
            { m: "M4", q: "A digitaliza√ß√£o no mercado financeiro busca:", o: ["Reduzir concorr√™ncia", "Melhorar experi√™ncia do cliente", "Aumentar burocracia", "Eliminar atendimento"], a: 1, e: "Foco na usabilidade, agilidade e custo menor." },
            { m: "M4", q: "O uso de dados no mercado financeiro permite:", o: ["Decis√µes aleat√≥rias", "Personaliza√ß√£o de produtos", "Menos controle", "Exclus√£o financeira"], a: 1, e: "Com mais dados, o banco oferece exatamente o que voc√™ precisa (Hiperpersonaliza√ß√£o)." },
            { m: "M4", q: "Open Finance depende de:", o: ["Decis√£o do banco", "Autoriza√ß√£o do cliente", "Regulador", "Governo"], a: 1, e: "Consentimento √© a base." },
            { m: "M4", q: "Fintechs se destacam por:", o: ["Burocracia", "Uso intensivo de tecnologia", "Atua√ß√£o estatal", "Exclusividade banc√°ria"], a: 1, e: "Inova√ß√£o tecnol√≥gica." },
            { m: "M4", q: "ESG influencia:", o: ["Apenas rentabilidade", "Apenas risco", "Decis√µes de investimento", "Pol√≠tica monet√°ria"], a: 2, e: "Crit√©rios socioambientais pesam na escolha." },
            { m: "M4", q: "Investimentos sustent√°veis buscam:", o: ["Lucro imediato", "Impacto positivo e retorno financeiro", "Isen√ß√£o fiscal", "Seguran√ßa absoluta"], a: 1, e: "Retorno + Prop√≥sito." },
            { m: "M4", q: "Big Data no mercado financeiro permite:", o: ["Decis√µes gen√©ricas", "Produtos personalizados", "Menor controle", "Exclus√£o digital"], a: 1, e: "An√°lise de dados para ofertas sob medida." },
            { m: "Geral", q: "Produto mais indicado para cliente conservador:", o: ["A√ß√µes", "ETF", "CDB ou Tesouro Selic", "Fundo de a√ß√µes"], a: 2, e: "Baixo risco e alta previsibilidade." },
            { m: "Geral", q: "Maior risco geralmente est√° associado a:", o: ["Renda fixa", "Curto prazo", "Renda vari√°vel", "FGC"], a: 2, e: "Renda Vari√°vel n√£o tem garantia de retorno nem do principal." },
            { m: "Geral", q: "A autorregula√ß√£o da ANBIMA tem como objetivo:", o: ["Substituir o BACEN", "Aumentar impostos", "Elevar padr√µes de mercado", "Controlar juros"], a: 2, e: "Criar um mercado mais forte, transparente e √©tico." },
            { m: "Geral", q: "A liquidez de um investimento representa:", o: ["Rentabilidade", "Seguran√ßa", "Facilidade de resgate", "Tributa√ß√£o"], a: 2, e: "Velocidade em transformar o ativo em dinheiro na conta." },
            { m: "Geral", q: "O profissional certificado deve sempre:", o: ["Priorizar metas internas", "Priorizar o cliente e agir com √©tica", "Oferecer o produto mais caro", "Evitar riscos"], a: 1, e: "O cliente vem em primeiro lugar. Sempre." },
            { m: "Geral", q: "Um cliente conservador com reserva de emerg√™ncia deve priorizar:", o: ["A√ß√µes", "Multimercado", "Tesouro Selic", "Deb√™ntures"], a: 2, e: "Seguran√ßa e liquidez." },
            { m: "Geral", q: "Quanto maior o risco, maior tende a ser:", o: ["A garantia", "A liquidez", "O retorno esperado", "A previsibilidade"], a: 2, e: "Rela√ß√£o Risco x Retorno." },
            { m: "Geral", q: "Autorregula√ß√£o da ANBIMA visa:", o: ["Punir investidores", "Aumentar impostos", "Boas pr√°ticas de mercado", "Substituir o BACEN"], a: 2, e: "Elevar o padr√£o do mercado." },
            { m: "Geral", q: "Liquidez di√°ria significa:", o: ["Rentabilidade fixa", "Resgate r√°pido", "Isen√ß√£o de IR", "Baixo risco"], a: 1, e: "Dinheiro na m√£o em D+0 ou D+1." },
            { m: "Geral", q: "O profissional CPA deve sempre agir com:", o: ["Foco em vendas", "√âtica e interesse do cliente", "Press√£o comercial", "Sigilo opcional"], a: 1, e: "Postura √©tica √© fundamental." }
        ];

        // --- ESTADO GLOBAL ---
        let currentTab = 'plano';
        let currentQuestionIdx = 0;
        let score = 0;
        let isAnswered = false;
        let selectedOptionIdx = null;
        let timerInterval;
        let totalSeconds = 0;
        let currentQuizFilter = 'all'; // Filtro atual do quiz
        let activeQuestions = []; // Quest√µes ativas no momento

        // --- PERSIST√äNCIA ---
        function saveQuizState() {
            const state = {
                filter: currentQuizFilter,
                questions: activeQuestions,
                idx: currentQuestionIdx,
                score: score,
                seconds: totalSeconds,
                isAnswered: isAnswered,
                selectedOptionIdx: selectedOptionIdx
            };
            localStorage.setItem('studyBankQuizState_v1', JSON.stringify(state));
        }

        function clearQuizState() {
            localStorage.removeItem('studyBankQuizState_v1');
        }

        // --- INICIALIZA√á√ÉO ---
        document.addEventListener('DOMContentLoaded', () => {
            renderTabs();
            renderContent();
            lucide.createIcons();
            
            setTimeout(() => {
                document.getElementById('study-tip').classList.remove('hidden');
            }, 3000);
        });

        // --- L√ìGICA DE NAVEGA√á√ÉO ---
        function renderTabs() {
            const container = document.getElementById('tabs-container');
            container.innerHTML = '';
            
            Object.values(studyData).forEach(tab => {
                const isActive = tab.id === currentTab;
                const btn = document.createElement('button');
                
                let classes = "pb-3 text-sm font-bold whitespace-nowrap transition-all flex items-center gap-2 outline-none border-b-2 ";
                if (isActive) {
                    classes += `${tab.borderClass} ${tab.textClass}`;
                } else {
                    classes += "text-gray-400 border-transparent hover:text-gray-600 hover:border-gray-200";
                }
                
                btn.className = classes;
                btn.onclick = () => switchTab(tab.id);
                btn.innerHTML = `<i data-lucide="${tab.icon}" class="w-4 h-4"></i> ${tab.title}`;
                container.appendChild(btn);
            });
            lucide.createIcons();
        }

        function switchTab(tabId) {
            currentTab = tabId;
            renderTabs();
            renderContent();
        }

        // --- L√ìGICA DE CONTE√öDO ---
        function renderContent() {
            const main = document.getElementById('main-content');
            const data = studyData[currentTab];
            
            let html = `
                <div class="mb-8 animate-fadeIn">
                    <h2 class="text-2xl font-bold text-gray-800 mb-1 flex items-center gap-2">
                        <span class="p-2 rounded-lg ${data.color} text-white"><i data-lucide="${data.icon}"></i></span>
                        ${data.title}
                    </h2>
                    <p class="text-sm text-gray-500 ml-12">Focado na Nova Certifica√ß√£o Base 2026</p>
                </div>
            `;

            if (data.isPlan) {
                html += `<div class="animate-fadeIn relative border-l-2 border-gray-200 ml-4 space-y-8">`;
                data.steps.forEach((step, idx) => {
                    html += `
                    <div class="mind-map-node ml-6 bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow">
                        <div class="absolute -left-[31px] top-5 w-4 h-4 rounded-full bg-gray-800 border-4 border-white shadow-sm"></div>
                        <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-2">
                            <span class="text-xs font-bold uppercase tracking-wider text-indigo-600 bg-indigo-50 px-2 py-1 rounded">Semana ${step.week}</span>
                            <span class="text-xs text-gray-400 font-medium mt-1 sm:mt-0">Fase ${idx + 1}</span>
                        </div>
                        <h3 class="text-lg font-bold text-gray-800 mb-1">${step.module}</h3>
                        <p class="text-sm text-gray-600 mb-3">${step.focus}</p>
                        <div class="text-xs bg-gray-50 p-2 rounded text-gray-500 flex items-center gap-2">
                            <i data-lucide="check-square" class="w-3 h-3 text-green-500"></i>
                            <strong>Pr√°tica:</strong> ${step.action}
                        </div>
                    </div>`;
                });
                html += `</div>`;
            } else {
                html += '<div class="animate-fadeIn grid gap-4">';
                data.topics.forEach((topic, idx) => {
                    const topicId = `topic-${idx}`;
                    let keywordsHtml = '';
                    if (topic.keywords) {
                        keywordsHtml = `<div class="flex flex-wrap gap-2 mb-3">
                            ${topic.keywords.map(k => `<span class="keyword-tag">${k}</span>`).join('')}
                        </div>`;
                    }
                    
                    let caseHtml = '';
                    if (topic.practicalCase) {
                        caseHtml = `
                            <div class="mb-5 p-4 bg-indigo-50 rounded-xl border border-indigo-100 text-sm text-indigo-900 shadow-sm">
                                <strong class="flex items-center gap-2 mb-2 text-indigo-700 uppercase tracking-wide text-xs">
                                    <i data-lucide="briefcase" class="w-4 h-4"></i> Case Pr√°tico
                                </strong>
                                <p class="leading-relaxed">${topic.practicalCase}</p>
                            </div>`;
                    }

                    let detailsHtml = '<div class="grid gap-3 mt-4">';
                    if (topic.details) {
                        topic.details.forEach(d => {
                            detailsHtml += `
                                <div class="bg-gray-50 p-3 rounded-lg border border-gray-100">
                                    <span class="text-xs font-bold text-gray-500 uppercase block mb-1">${d.label}</span>
                                    <span class="text-sm text-gray-800 font-medium leading-snug">${d.value}</span>
                                </div>`;
                        });
                    }
                    detailsHtml += '</div>';

                    let subTopicsHtml = '';
                    if (topic.subTopics) {
                        subTopicsHtml = '<div class="mt-4 space-y-2">';
                        topic.subTopics.forEach(sub => {
                            subTopicsHtml += `
                                <div class="flex gap-3 items-start p-2 hover:bg-gray-50 rounded transition-colors">
                                    <div class="mt-1 min-w-[6px] h-[6px] rounded-full ${data.color}"></div>
                                    <div>
                                        <strong class="text-sm text-gray-800 block">${sub.name}</strong>
                                        <span class="text-xs text-gray-600">${sub.text}</span>
                                    </div>
                                </div>`;
                        });
                        subTopicsHtml += '</div>';
                    }

                    html += `
                    <div class="bg-white rounded-xl border border-gray-200 overflow-hidden transition-all hover:shadow-lg hover:border-indigo-100 group">
                        <button onclick="toggleCard('${topicId}')" class="w-full text-left p-5 flex items-start justify-between cursor-pointer">
                            <div>
                                <h3 class="font-bold text-gray-800 text-lg group-hover:text-indigo-600 transition-colors">${topic.title}</h3>
                                <p class="text-sm text-gray-500 mt-1 line-clamp-2">${topic.description}</p>
                            </div>
                            <div class="bg-gray-100 p-2 rounded-full group-hover:bg-indigo-50 transition-colors mt-1">
                                <i id="icon-${topicId}" data-lucide="chevron-down" class="w-5 h-5 text-gray-400 group-hover:text-indigo-600 transition-transform"></i>
                            </div>
                        </button>
                        <div id="${topicId}" class="hidden px-5 pb-5 border-t border-gray-100 pt-4 animate-fadeIn">
                            ${keywordsHtml}
                            <p class="text-sm text-gray-500 mb-6 italic border-l-4 ${data.borderClass} pl-3 py-1">
                                "${topic.description}"
                            </p>
                            ${topic.content ? `<div class="rich-content prose prose-sm max-w-none text-gray-700 mb-6">${topic.content}</div>` : ''}
                            ${caseHtml}
                            ${subTopicsHtml}
                            ${detailsHtml}
                        </div>
                    </div>`;
                });
                html += '</div>';
            }

            main.innerHTML = html;
            lucide.createIcons();
        }

        function toggleCard(id) {
            const content = document.getElementById(id);
            const icon = document.getElementById(`icon-${id}`);
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // --- TIMER ---
        function startTimer() {
            // totalSeconds mantido do estado ou 0
            const timerDisplay = document.getElementById('quiz-timer');
            clearInterval(timerInterval);
            
            // Renderiza o tempo inicial imediatamente para n√£o esperar 1s
            const minutes = Math.floor(totalSeconds / 60).toString().padStart(2, '0');
            const seconds = (totalSeconds % 60).toString().padStart(2, '0');
            timerDisplay.textContent = `${minutes}:${seconds}`;

            timerInterval = setInterval(() => {
                totalSeconds++;
                const minutes = Math.floor(totalSeconds / 60).toString().padStart(2, '0');
                const seconds = (totalSeconds % 60).toString().padStart(2, '0');
                timerDisplay.textContent = `${minutes}:${seconds}`;
            }, 1000);
        }

        function stopTimer() {
            clearInterval(timerInterval);
        }

        // --- L√ìGICA DO QUIZ (ATUALIZADA) ---
        function openQuiz() {
            document.getElementById('quiz-modal').classList.remove('hidden');
            
            const savedState = localStorage.getItem('studyBankQuizState_v1');
            if (savedState) {
                try {
                    const state = JSON.parse(savedState);
                    currentQuizFilter = state.filter;
                    activeQuestions = state.questions;
                    currentQuestionIdx = state.idx;
                    score = state.score;
                    totalSeconds = state.seconds;
                    isAnswered = state.isAnswered || false;
                    selectedOptionIdx = state.selectedOptionIdx;
                    
                    // Renderiza abas com o filtro ativo correto
                    renderQuizTabs();
                    document.getElementById('question-count-badge').textContent = `${activeQuestions.length} Quest√µes`;
                    
                    renderQuestion();
                    startTimer();
                } catch (e) {
                    console.error("Erro ao carregar quiz salvo", e);
                    setQuizFilter('all');
                }
            } else {
                setQuizFilter('all'); // Inicia com todos por padr√£o
            }
        }

        function closeQuiz() {
            stopTimer();
            saveQuizState(); // Salva ao fechar
            document.getElementById('quiz-modal').classList.add('hidden');
        }

        function restartQuiz() {
            if(confirm("Deseja realmente reiniciar o simulado? Todo o progresso atual ser√° perdido.")) {
                clearQuizState();
                setQuizFilter(currentQuizFilter);
            }
        }

        function renderQuizTabs() {
            const tabsContainer = document.getElementById('quiz-tabs-container');
            const filters = [
                { id: 'all', label: 'Geral' },
                { id: 'M1', label: 'M√≥dulo 1' },
                { id: 'M2', label: 'M√≥dulo 2' },
                { id: 'M3', label: 'M√≥dulo 3' },
                { id: 'M4', label: 'M√≥dulo 4' }
            ];
            
            tabsContainer.innerHTML = filters.map(f => `
                <button onclick="changeQuizFilter('${f.id}')" 
                    class="quiz-tab ${currentQuizFilter === f.id ? 'active' : 'inactive'} whitespace-nowrap">
                    ${f.label}
                </button>
            `).join('');
        }

        function changeQuizFilter(filter) {
            // Se mudar de aba, confirma se quer perder o progresso atual (j√° que √© um novo filtro)
            if (filter !== currentQuizFilter) {
                if(confirm("Mudar o m√≥dulo ir√° reiniciar o simulado atual. Continuar?")) {
                    setQuizFilter(filter);
                }
            }
        }

        function setQuizFilter(filter) {
            currentQuizFilter = filter;
            clearQuizState(); // Limpa estado anterior pois √© um novo quiz
            
            renderQuizTabs();

            // Filtra as quest√µes
            if (filter === 'all') {
                activeQuestions = [...quizQuestions];
                // Embaralha para o simulado geral
                activeQuestions.sort(() => Math.random() - 0.5);
            } else {
                activeQuestions = quizQuestions.filter(q => q.m === filter);
                // Embaralha tamb√©m nos m√≥dulos
                activeQuestions.sort(() => Math.random() - 0.5);
            }

            // Atualiza badge de contagem
            document.getElementById('question-count-badge').textContent = `${activeQuestions.length} Quest√µes`;

            resetQuiz(); // Reseta √≠ndices e score
            startTimer();
            saveQuizState(); // Salva o estado inicial
        }

        function resetQuiz() {
            currentQuestionIdx = 0;
            score = 0;
            isAnswered = false;
            selectedOptionIdx = null;
            totalSeconds = 0; // Reinicia tempo
            renderQuestion();
        }

        function renderQuestion() {
            const body = document.getElementById('quiz-body');
            const footer = document.getElementById('quiz-footer');
            
            if (currentQuestionIdx >= activeQuestions.length) {
                renderResult();
                return;
            }

            const q = activeQuestions[currentQuestionIdx];

            let optionsHtml = '<div class="grid gap-3 mt-4">';
            q.o.forEach((opt, idx) => {
                let classes = "w-full text-left p-4 rounded-xl border-2 transition-all flex items-center justify-between group relative ";
                let icon = '';

                if (isAnswered) {
                    if (idx === q.a) {
                        classes += "border-green-500 bg-green-50 text-green-900";
                        icon = '<i data-lucide="check-circle" class="text-green-600"></i>';
                    } else if (idx === selectedOptionIdx) {
                        classes += "border-red-300 bg-red-50 text-red-900";
                        icon = '<i data-lucide="x-circle" class="text-red-500"></i>';
                    } else {
                        classes += "border-gray-100 text-gray-400 opacity-50";
                    }
                } else {
                    classes += "border-gray-200 bg-white hover:border-indigo-400 hover:shadow-md text-gray-700 cursor-pointer";
                }

                const clickHandler = isAnswered ? '' : `onclick="handleAnswer(${idx})"`;

                optionsHtml += `
                    <button ${clickHandler} class="${classes}">
                        <span class="font-medium pr-6">${opt}</span>
                        ${icon}
                    </button>`;
            });
            optionsHtml += '</div>';

            let explanationHtml = '';
            if (isAnswered) {
                const isCorrect = selectedOptionIdx === q.a;
                const feedbackColor = isCorrect ? "blue" : "amber";
                explanationHtml = `
                    <div class="mt-4 p-4 bg-${feedbackColor}-50 rounded-xl border border-${feedbackColor}-100 animate-fadeIn text-sm text-${feedbackColor}-900 shadow-sm">
                        <strong class="flex items-center gap-2 mb-1 text-${feedbackColor}-700">
                            <i data-lucide="${isCorrect ? 'thumbs-up' : 'lightbulb'}" class="w-4 h-4"></i> 
                            ${isCorrect ? 'Correto!' : 'Aten√ß√£o!'}
                        </strong>
                        ${q.e}
                    </div>`;
            }

            body.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <span class="text-[10px] font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded uppercase tracking-wider border border-indigo-100">${q.m}</span>
                    <span class="text-xs text-gray-400 font-medium">Quest√£o ${currentQuestionIdx + 1} de ${activeQuestions.length}</span>
                </div>
                <div class="h-1 w-full bg-gray-100 rounded-full mb-6 overflow-hidden">
                    <div class="h-full bg-indigo-500 transition-all duration-300" style="width: ${((currentQuestionIdx) / activeQuestions.length) * 100}%"></div>
                </div>
                <h4 class="text-lg font-bold text-gray-800 leading-snug">${q.q}</h4>
                ${optionsHtml}
                ${explanationHtml}
            `;

            if (isAnswered) {
                footer.innerHTML = `
                    <div class="text-sm font-bold text-gray-500">Acertos: <span class="text-indigo-600">${score}</span></div>
                    <button onclick="nextQuestion()" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-indigo-700 transition-colors flex items-center gap-2 shadow-lg shadow-indigo-200">
                        Pr√≥xima <i data-lucide="arrow-right" class="w-4 h-4"></i>
                    </button>`;
            } else {
                footer.innerHTML = `
                    <div class="text-sm font-bold text-gray-400">Escolha uma alternativa...</div>
                    <button disabled class="bg-gray-100 text-gray-300 px-6 py-3 rounded-lg font-bold cursor-not-allowed">
                        Pr√≥xima
                    </button>`;
            }
            lucide.createIcons();
        }

        function handleAnswer(idx) {
            if (isAnswered) return;
            isAnswered = true;
            selectedOptionIdx = idx;
            // Salva se acertou na quest√£o atual para estat√≠sticas (opcional, mas bom pra feedback detalhado)
            activeQuestions[currentQuestionIdx].userCorrect = (idx === activeQuestions[currentQuestionIdx].a);
            
            if (idx === activeQuestions[currentQuestionIdx].a) score++;
            
            saveQuizState(); // Salva progresso
            renderQuestion();
        }

        function nextQuestion() {
            currentQuestionIdx++;
            isAnswered = false;
            selectedOptionIdx = null;
            saveQuizState(); // Salva nova posi√ß√£o
            renderQuestion();
        }

        function renderResult() {
            stopTimer();
            clearQuizState(); // Limpa o save ao finalizar
            const body = document.getElementById('quiz-body');
            const footer = document.getElementById('quiz-footer');
            footer.innerHTML = '';

            const percentage = Math.round((score / activeQuestions.length) * 100);
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            
            let message = "";
            let color = "";
            
            if (percentage >= 70) {
                message = "Excelente! Voc√™ estaria APROVADO!";
                color = "text-green-600";
            } else if (percentage >= 50) {
                message = "Quase l√°! Revise os pontos fracos.";
                color = "text-amber-600";
            } else {
                message = "Precisa estudar mais. N√£o desanime!";
                color = "text-red-600";
            }

            // Gerar Feedback por M√≥dulo (se estiver no modo Geral)
            let feedbackHtml = '';
            if (currentQuizFilter === 'all') {
                const stats = { M1: {t:0, c:0}, M2: {t:0, c:0}, M3: {t:0, c:0}, M4: {t:0, c:0}, Geral: {t:0, c:0} };
                
                activeQuestions.forEach(q => {
                    const mod = q.m;
                    if(stats[mod]) {
                        stats[mod].t++;
                        if(q.userCorrect) stats[mod].c++;
                    } else if (mod === 'Geral') {
                         stats.Geral.t++;
                         if(q.userCorrect) stats.Geral.c++;
                    }
                });

                feedbackHtml = `<div class="w-full max-w-sm mx-auto bg-white rounded-lg border border-gray-100 p-4 mb-6 text-left shadow-sm">
                    <h4 class="font-bold text-gray-700 mb-3 text-sm border-b pb-2">Desempenho por M√≥dulo</h4>
                    <div class="space-y-3 text-xs">`;
                
                Object.keys(stats).forEach(key => {
                    if (stats[key].t > 0) {
                        const p = Math.round((stats[key].c / stats[key].t) * 100);
                        const barColor = p >= 70 ? 'bg-green-500' : (p >= 50 ? 'bg-yellow-400' : 'bg-red-400');
                        feedbackHtml += `
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="font-medium text-gray-600">${key}</span>
                                    <span class="font-bold text-gray-800">${p}%</span>
                                </div>
                                <div class="w-full bg-gray-100 rounded-full h-2">
                                    <div class="${barColor} h-2 rounded-full" style="width: ${p}%"></div>
                                </div>
                            </div>
                        `;
                    }
                });
                feedbackHtml += `</div></div>`;
            }

            body.innerHTML = `
                <div class="text-center py-6 animate-fadeIn h-full flex flex-col justify-center items-center overflow-y-auto">
                    <div class="relative mb-6">
                        <div class="w-24 h-24 rounded-full border-8 border-gray-100 flex items-center justify-center">
                            <i data-lucide="trophy" class="w-10 h-10 text-indigo-200"></i>
                        </div>
                        <div class="absolute inset-0 w-24 h-24 rounded-full border-8 border-indigo-600 border-t-transparent animate-spin" style="animation-duration: 3s;"></div>
                        <div class="absolute inset-0 flex items-center justify-center font-black text-xl text-indigo-700">
                            ${percentage}%
                        </div>
                    </div>
                    
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Simulado Finalizado</h2>
                    <p class="text-gray-500 mb-2">Voc√™ acertou <strong class="text-indigo-600">${score}</strong> de <strong class="text-gray-800">${activeQuestions.length}</strong> quest√µes.</p>
                    <p class="text-xs text-gray-400 mb-6 font-mono">Tempo total: ${minutes}m ${seconds}s</p>
                    
                    <p class="text-lg font-bold ${color} mb-6 bg-gray-50 px-4 py-2 rounded-lg inline-block shadow-sm border border-gray-100">${message}</p>
                    
                    ${feedbackHtml}
                    
                    <button onclick="setQuizFilter('${currentQuizFilter}');" class="bg-indigo-600 text-white px-8 py-3 rounded-full font-bold hover:bg-indigo-700 transition-colors flex items-center gap-2 shadow-xl mt-2">
                        <i data-lucide="rotate-ccw" class="w-4 h-4"></i> Refazer Simulado
                    </button>
                </div>
            `;
            lucide.createIcons();
        }

    </script>
</body>
</html>
